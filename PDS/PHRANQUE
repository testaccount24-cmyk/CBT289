*          DATA SET CBT1089    AT LEVEL 006 AS OF 10/22/80
*PROGRAM DESCRIPTION:                                                   00001
*                                                                       00002
*       EXTERNAL REQUIREMENTS: IEFSD095                                 00003
*                     LIBRARY: SYS1.AOSB0                               00004
*                                                                       00005
*       SYS1.APVTMACS IS A REQUIRED MACRO LIBRARY.                      00006
*             (TO ACCESS MACROS IHADECB AND IHASTOW)                    00007
*                                                                       00008
*       TO USE THE FACILITIES OF THE BLOCK AND HEADER                   00009
*       KEYWORDS, MODULE IEFSD095 MUST BE INCLUDED FROM                 00010
*       SYS1.AOSB0 AT LINK EDIT.                                        00011
*                                                                       00012
*       PHRANQUE IS A PTF UTILITY PRIMARILY INTENDED TO PROVIDE         00013
*       A CONVENIENT MEANS OF CREATING COVER LETTERS FROM THE PTF       00014
*       FILE OF A PUT TAPE. ADDITIONAL FEATURES ASSOCIATED WITH         00015
*       COVER LETTER PROCESSING, INTENDED TO ENHANCE ITS                00016
*       USABILITY, MAY BE REQUESTED VIA THE CONTROL DATASET.            00017
*       THESE FEATURES ARE:                                             00018
*                                                                       00019
*             BLOCK PRINT THE PTF NUMBER BEFORE EACH COVER LETTER       00020
*             TO MAKE MICROFICHE COPIES EASIER TO SCAN. (BLOCK)         00021
*                                                                       00022
*             START EACH COVER LETTER ON A NEW PAGE. (EJECT)            00023
*                                                                       00024
*             CHANGE THE PAGE SIZE. (LINES)                             00025
*                                                                       00026
*             PROVIDE A LIST OF PTF'S CONTAINED IN THE                  00027
*             COVER LETTER LISTING. (PTFLIST)                           00028
*                                                                       00029
*             PROVIDE A CROSS REFERENCE LIST INDICATING                 00030
*             WHICH PTF'S WILL HIT EACH ELEMENT. (XREF)                 00031
*                                                                       00032
*             PROVIDE A CROSS REFERENCE OF WHICH PTF'S APPLY            00033
*             TO EACH FUNCTION. (FMIDLIST)                              00034
*                                                                       00035
*             LIST THE COVER LETTERS IN ASSENDING ORDER BY              00036
*             PTF NUMBER. (SORT)                                        00037
*                                                                       00038
*       OTHER FUNCTIONS AVAILABLE ARE:                                  00039
*                                                                       00040
*             CONTROL OVER WHICH PTF'S ARE TO BE PROCESSED.             00041
*             IT IS POSSIBLE TO PROCESS ONLY SPECIFIED                  00042
*             PTF'S (INCLUDE) OR TO PROCESS ALL EXCEPT A                00043
*             LIST OF SPECIFIED PTF'S (EXCLUDE).                        00044
*                                                                       00045
*             OMIT TEXT ELEMENT IF A SOURCE UPDATE ELEMENT              00046
*             WITH THE SAME ELEMENT NAME EXISTS WITHIN A                00047
*             PTF. (NOMOD)                                              00048
*                                                                       00049
*             PRODUCE A COPY OF THE PROCESSED PTF'S AS                  00050
*             SPECIFIED IN THE CONTROL DATASET.                         00051
*             (IF SORT WAS SPECIFIED, THE COPIED PTF'S                  00052
*             WILL BE SORTED; IF NOMOD WAS SPECIFIED,                   00053
*             COPIED PTF'S WILL NOT CONTAIN TEXT ELEMENTS               00054
*             FOR WHICH A SOURCE UPDATE EXISTS; AND THE                 00055
*             CONTENTS OF THE COPIED OUTPUT WILL BE TAILORED            00056
*             AS SPECIFIED BY ANY INCLUDE OR EXCLUDE LIST               00057
*             PROVIDED)                                                 00058
*                                                                       00059
*             MERGE THE PTF'S SELECTED FROM THE PTFIN DATASET           00060
*             INTO AN EXISTING DATASET AS SPECIFIED BY PTFOUT,          00061
*             REPLACE DUPLICATE PTF'S WITH THE LAST COPY EXISTING       00062
*             ON PTFOUT OR WITH A COPY FROM PTFIN IF ONE EXISTS,        00063
*             AND CREATE A COVER LETTER LISTING WHICH REFLECTS          00064
*             THE NEW CONTENTS OF THE PTFOUT DATASET. THIS              00065
*             FUNCTION IS AUTOMATICALLY INVOKED WHEN SORT IS            00066
*             REQUESTED AND A PTFOUT DD STATEMENT IS INCLUDED           00067
*             WHICH DOES NOT SPECIFY A DISPOSITION OF NEW OR            00068
*             MOD. THE OPTION TO UNCONDITIONALLY BYPASS THE             00069
*             MERGE FUNCTION IS AVAILABLE. (NOMERGE) TO AVOID           00070
*             ACCIDENTAL LOSS OF DATA, IF NOMERGE IS SPECIFIED          00071
*             OR IF SORT IS NOT SPECIFIED, A DISPOSITION OF             00072
*             OLD (FOR PTFOUT) WILL BE AUTOMATICALLY CHANGED            00073
*             TO A DISPOSITION OF MOD.                                  00074
         EJECT                                                          00075
*             PHRANQUE WILL ALSO SEPERATE NON-SMP DATA FROM             00076
*             SMP FORMAT DATA IF THE PTFIN DATASET IS                   00077
*             ARRANGED SUCH THAT ALL OF THE NON-SMP DATA                00078
*             IS BEFORE THE SMP FORMAT DATA. (THIS FUNCTION             00079
*             WILL, FOR EXAMPLE, SEPERATE PUTDOC FROM PTF'S             00080
*             OBTAINED IN THE SAME DLS RUN. IT IS NECESSARY TO          00081
*             SPECIFY THAT THE PUTDOC MUST BE TRANSFERRED               00082
*             FIRST.) AS PTFIN IS READ, ALL STATEMENTS PRIOR            00083
*             TO THE FIRST ++ SYSMOD HEADER WILL BE WRITTEN             00084
*             TO THE SYSPUNCH DATASET. THE FIRST ++ SYSMOD              00085
*             HEADER STATEMENT INDICATES THE BEGINNING OF               00086
*             SMP FORMAT DATA AND ALL SUBSEQUENT STATEMENTS             00087
*             ARE CONSIDERED PTF'S.                                     00088
         EJECT                                                          00089
*DD STATEMENTS:                                                         00090
*                                                                       00091
*       SYSIN    =>CONTROL DATASET. SEE KEYWORD PARAMETERS.             00092
*                  LRECL=80,BLKSIZE MUST BE SPECIFIED.IF SYSIN          00093
*                  IS OMITTED OR SPECIFIED AS DUMMY, PROCESSING         00094
*                  WILL CONSIST OF TOTALLY COPYING THE CONTENTS         00095
*                  OF THE PTFIN DATASET, STARTING WITH THE FIRST        00096
*                  ++ SYSMOD HEADER STATEMENT, TO THE PTFOUT            00097
*                  DATASET (IF A PTFOUT DD STATEMENT EXISTS),           00098
*                  ALL RECORDS READ FROM THE PTFIN DATASET PRIOR        00099
*                  TO THE FIRST ++ SYSMOD HEADER STATEMENT WILL         00100
*                  BE COPIED TO THE SYSPUNCH DATASET (IF A              00101
*                  SYSPUNCH DD STATEMENT EXISTS) AND COVER              00102
*                  LETTER INFORMATION WILL BE WRITTEN TO THE            00103
*                  PTFDATA DATASET. DSORG=PS.                           00104
*                                                                       00105
*       PTFDATA  =>OUTPUT DATASET CONTAINING PTF COVER LETTERS,         00106
*                  AND ALL REQUESTED LISTS. IF A SORT WAS REQUESTED     00107
*                  AND A SYSUT2 DATASET WAS PROVIDED, THE PTFLIST       00108
*                  AND XREF (IF REQUESTED) WILL BE FIRST, FOLLOWED      00109
*                  BY THE PTF COVER LETTERS IN ASSENDING SEQUENCE       00110
*                  BY PTF NUMBER, WITH THE FMIDLIST (IF REQUESTED)      00111
*                  LAST. IF A SORT WAS NOT REQUESTED, THE PTF           00112
*                  COVER LETTERS WILL OCCUR FIRST, ARRANGED IN          00113
*                  THE SAME ORDER AS THE EXIST ON THE PTFIN             00114
*                  DATASET, FOLLOWED BY THE LISTS (AS REQUESTED).       00115
*                  LRECL IS 121 WITH MACHINE PRINT CONTROL              00116
*                  CHARACTERS. BLKSIZE MUST BE SPECIFIED AS             00117
*                  A MULTIPLE OF 121 (BUT NOT 121). THIS                00118
*                  STATEMENT IS REQUIRED. DSORG=PS                      00119
*                                                                       00120
*       PTFIN    =>INPUT DATASET CONTAINING PTF'S FOR                   00121
*                  PROCESSING. LRECL IS 80. RECFM AND BLKSIZE           00122
*                  MUST BE SPECIFIED. THIS STATEMENT IS                 00123
*                  REQUIRED. DSORG=PS                                   00124
*                                                                       00125
*       PTFOUT   =>OUTPUT DATASET CONTAINING PTF'S COPIED               00126
*                  FROM PTFIN. FURTHER INFORMATION REGUARDING           00127
*                  THIS DATASET MAY BE FOUND IN THE PROGRAM             00128
*                  DESCRIPTION. THIS STATEMENT IS OPTIONAL              00129
*                  AND IF OMITTED, PROCESSING IS THE SAME               00130
*                  AS SPECIFING DUMMY. LRECL IS 80. BLKSIZE             00131
*                  MUST BE SPECIFIED AS 80 OR A MULTIPLE                00132
*                  OF 80. DSORG=PS                                      00133
*                                                                       00134
*       SYSUT1   =>OPTIONAL SEQUENTIAL WORK DATASET REQUIRED TO         00135
*                  PERFORM THE NOMOD FUNCTION. SEE THE PROGRAM          00136
*                  DESCRIPTION AND NOMOD KEYWORD DESCRIPTION            00137
*                  FOR MORE INFORMATION.                                00138
*                                                                       00139
*       SYSUT2   =>OPTIONAL PARTITIONED WORK DATASET REQUIRED           00140
*                  TO PERFORM THE SORT FUNCTION. SEE THE                00141
*                  PROGRAM DESCRIPTION FOR MORE INFORMATION.            00142
*                                                                       00143
*       SYSPRINT =>PRINT DATASET FOR MESSAGES.LRECL AND                 00144
*                  BLKSIZE ARE 121, WITH MACHINE PRINT                  00145
*                  CONTROL CHARACTERS. THIS STATEMENT IS                00146
*                  REQUIRED. DSORG=PS                                   00147
*                                                                       00148
*       SYSPUNCH =>OUTPUT DATASET WHICH WILL CONTAIN ALL                00149
*                  RECORDS READ FROM PTFIN PRIOR TO THE FIRST           00150
*                  ++ SYSMOD HEADER STATEMENT. THIS STATEMENT           00151
*                  IS OPTIONAL. IF IT IS OMITTED, PROCESSING            00152
*                  IS THE SAME AS SPECIFING DUMMY. DSORG=PS             00153
         EJECT                                                          00154
*KEYWORD PARAMETERS:                                                    00155
*                                                                       00156
*       THE FORMAT OF THE CONTROL STATEMENTS IS FREE FORM. EACH         00157
*       KEYWORD MAY BE LOCATED ANYWHERE IN COLUMNS 1 THROUGH 72         00158
*       (COLUMNS 73 THROUGH 80 ARE IGNORED). AN ASTERISK IN             00159
*       COLUMN 1 INDICATES A COMMENT AND THAT STATEMENT IS              00160
*       IGNORED. WHEN A KEYWORD HAS SYNTAX CONSIDERATIONS,              00161
*       THESE ARE OUTLINED IN THE ASSOCIATED KEYWORD                    00162
*       DESCRIPTION.                                                    00163
*                                                                       00164
*       THE FOLLOWING PARAMETERS MAY BE SPECIFIED IN THE                00165
*       CONTROL DATASET OR AS PARAMETERS ON THE EXECUTE                 00166
*       STATEMENT OR A COMBINATION. NOTE: EACH KEYWORD                  00167
*       MAY BE SPECIFIED ONLY ONCE.                                     00168
*                                                                       00169
*       BLOCK    =>PRINT THE PTF NUMBER IN BLOCK LETTERS BEFORE         00170
*                  EACH COVER LETTER                                    00171
*                                                                       00172
*       EJECT    =>BEGIN EACH COVER LETTER ON A NEW PAGE                00173
*                                                                       00174
*       SORT     =>PLACE PTF'S IN COALATING SEQUENCE IN BOTH            00175
*                  THE PRINTED OUTPUT AND MACHINE READABLE PTF          00176
*                  OUTPUT (PRESENT IF THE PTFOUT DD STATEMENT           00177
*                  IS PROVIDED). SYSUT2 IS REQUIRED TO PERFORM          00178
*                  THIS FUNCTION.                                       00179
*                                                                       00180
*       NOMOD    =>DO NOT PLACE A MOD ELEMENT IN THE PTFOUT             00181
*                  DATASET IF A SOURCE ELEMENT OF THE SAME              00182
*                  NAME EXISTS WITHIN THE PTF. SYSUT1 IS                00183
*                  REQUIRED TO PERFORM THIS FUNCTION.                   00184
*                                                                       00185
*       EXCLUDE                                                         00186
*          OR    =>PROVIDES A LIST OF PTF'S TO BE EXCLUDED FROM         00187
*       INCLUDE    THE OUTPUT OR A LIST OF PTF'S WHICH WILL BE          00188
*                  SELECTED (INCLUDE) FROM PTFIN TO BE INCLUDED         00189
*                  IN THE OUTPUT. THE LIST IS IN PARENTHESES            00190
*                  AND MAY SPAN SEVERAL INPUT RECORDS. PTF              00191
*                  NUMBERS MUST BE SEPERATED BY ONE OR MORE             00192
*                  SPACES. A COMMA IS OPTIONAL.                         00193
*                                                                       00194
*                  FOR EXAMPLE:  TO PROCESS 3 SPECIFIC PTF'S            00195
*                                FROM PTFIN, SPECIFY                    00196
*                                                                       00197
*                  INCLUDE  (AA11111 AA22222  , AA33333  )              00198
*                                                                       00199
*                  THE DEFAULT MAXIMUM LIST SIZE IS 50. IT MAY BE       00200
*                  CHANGED BY SPECIFING A NEW MAXIMUM LIST SIZE         00201
*                  AS SHOWN IN THE FOLLOWING EXAMPLE:                   00202
*                                                                       00203
*                  EXCLUDE = 100 (BB11111,BB22222 ....)                 00204
*                                                                       00205
*                  INCLUDE AND EXCLUDE ARE MUTUALLY EXCLUSIVE.          00206
*                  THIS LIST APPLIES ONLY TO PTF'S READ FROM            00207
*                  THE PTFIN DATASET. READBACK OF PTFOUT                00208
*                  IS NOT AFFECTED. (SEE PROGRAM DESCRIPTION)           00209
*                                                                       00210
*       PTFLIST  =>INCLUDE, IN THE PRINTED OUTPUT, A LIST               00211
*                  OF THE NUMBERS OF ALL PTF'S PROCESSED.               00212
*                                                                       00213
         EJECT                                                          00214
*       XREF     =>INCLUDE, IN THE PRINTED OUTPUT, A CROSS              00215
*                  REFERENCE LIST OF WHICH PTF'S CONTAIN                00216
*                  EACH ELEMENT NAME, BY ELEMENT NAME.                  00217
*                                                                       00218
*       FMIDLIST =>INCLUDE, IN THE PRINTED OUTPUT, A CROSS              00219
*                  REFERENCE LIST OF WHICH PTF'S APPLY TO               00220
*                  EACH FUNCTION, BY FUNCTION NAME.                     00221
*                                                                       00222
*       SYSMODS  =>EACH LIST (PTFLIST, XREF, AND FMIDLIST)              00223
*                  REQUIRES AN INTERNAL TABLE. THE DEFAULT              00224
*                  TABLE SIZE ALLOWS A MAXIMUM OF 1500 PTF'S            00225
*                  TO BE PROCESSED. SPACE FOR THE XREF TABLE            00226
*                  IS BASED ON AN AVERAGE OF 8 ELEMENTS PER             00227
*                  PTF. SPACE FOR THE FMIDLIST TABLE IS BASED           00228
*                  ON AN AVERAGE OF 4 VER STATEMENTS PER PTF.           00229
*                  THE SIZE OF THE TABLES MAY BE ALTERED BY             00230
*                  CHANGING THE THE MAXIMUM PTF'S ALLOWED VALUE         00231
*                  AS SHOWN IN THE FOLLOWING EXAMPLES:                  00232
*                                                                       00233
*                         SYSMODS ( 2000 )                              00234
*                                                                       00235
*                              OR                                       00236
*                                                                       00237
*                         SYSMODS = 500                                 00238
*                                                                       00239
*                  THE STORAGE REQUIRED FOR THESE TABLES MAY            00240
*                  BE CALCULATED AS FOLLOWS:                            00241
*                                                                       00242
*                  PTFLIST  = 16 + (8 * 1500 OR SYSMODS VALUE)          00243
*                                                                       00244
*                  XREF     = 16 + (64 * 1500 OR SYSMODS VALUE)         00245
*                                                                       00246
*                  FMIDLIST = 16 + (32 * 1500 OR SYSMODS VALUE)         00247
*                                                                       00248
*       LINES    =>SPECIFIES THE MAXIMUM NUMBER OF LINES PER            00249
*                  PAGE FOR THE PTFDATA DATASET. THE DEFAULT            00250
*                  LINE COUNT IS 55. FOR EXAMPLE:                       00251
*                                                                       00252
*                  LINES (60 )    OR    LINES =100                      00253
*                                                                       00254
*       NOMERGE  =>INHIBIT READING THE PTFOUT DATASET PRIOR             00255
*                  TO READING THE PTFIN DATASET. FURTHER                00256
*                  INFORMATION ON THIS FUNCTION IS CONTAINED            00257
*                  IN THE PROGRAM DESCRIPTION.                          00258
*                                                                       00259
*       HEADER   =>PRINT 2 PAGES OF HEADER DATA, IN BLOCK               00260
*                  LETTERS, AT THE BEGINNING AND END OF THE             00261
*                  PTFDATA DATASET. THE DATA MAY BE ANY                 00262
*                  PRINTABLE CHARACTERS NO EXCEEDING A                  00263
*                  MAXIMUM OF SEVEN. FOR EXAMPLE:                       00264
*                                                                       00265
*                  HEADER ( PTF'S)   OR   HEADER =PUT8008               00266
*                                                                       00267
*       END      =>OPTIONALLY USED TO INDICATE THE END OF               00268
*                  THE CONTROL DATASET. NO FURTHER CONTROL              00269
*                  STATEMENT SCANNING TAKES PLACE.                      00270
*                                                                       00271
         EJECT                                                          00272
*SAMPLE JCL                                                             00273
*                                                                       00274
*  //STEP01    EXEC PGM=PHRANQUE,REGION=1024K                           00275
*  //*                                                                  00276
*  //* THIS RUN WILL GENERATE THE FOLLOWING PTF TAPE XREF               00277
*  //* REPORTS.                                                         00278
*  //*                                                                  00279
*  //*        ALL REPORTS ARE IN EBCDIC COLLATING SEQUENCE              00280
*  //*                                                                  00281
*  //*      1. A LIST OF ALL THE PTF'S APPEARING ON THE TAPE            00282
*  //*                                                                  00283
*  //*      2. A LIST OF ALL ELEMENTS (MODULE, MACROS, ETC.) APPEARING  00284
*  //*         ON THE TAPE AND THE PTF'S THAT REFERENCE THEM            00285
*  //*                                                                  00286
*  //*      3. A LIST OF ALL THE COVER LETTERS AND THEIR JCLIN IF       00287
*  //*         THERE IS A JCLIN FOR THAT PTF                            00288
*  //*                                                                  00289
*  //*      4. A LIST OF ALL FMID'S APPEARING ON THE TAPE AND THE PTF'S 00290
*  //*         THAT REFERENCE THOSE FMIDS                               00291
*  //*                                                                  00292
*  //*    ABNLIGNR   >===  TO SUPRESS ANY ABENDAID OPTIONS (OPTIONAL)   00293
*  //*    SYSPRINT   >===  PRINT ANY MESSAGES AND CONTROL CARD ERRORS   00294
*  //*    SYSIN      >===  INPUT CONTROL STATEMENT                      00295
*  //*    SYSUT2     >===  TEMPORARY WORK PDS                           00296
*  //*    PTFIN      >===  INPUT PTF TAPE                               00297
*  //*    PTFDATA    >===  OUTPUT XREF REPORTS AND PTF COVER LETTERS    00298
*  //*    SYSUDUMP   >===  DUMP DD CARD                                 00299
*  //*                                                                  00300
*  //ABNLIGNR  DD  DUMMY                                                00301
*  //SYSPRINT  DD  SYSOUT=1                                             00302
*  //SYSIN     DD  *                                                    00303
*   BLOCK SORT EJECT PTFLIST XREF FMIDLIST LINES(80) HEADER(PUT8008)    00304
*  //SYSUT2    DD DSN=TEMPPDS,UNIT=(DASD,2),SPACE=(CYL,(50,30,200)),    00305
*  //          DISP=(NEW,PASS)                                          00306
*  //PTFIN     DD DSN=PTFS,VOL=SER=DLSTAP,UNIT=3400-5,DISP=(OLD,KEEP),  00307
*  //          LABEL=(1,NL),DCB=(RECFM=FB,LRECL=80,BLKSIZE=7200,DEN=4)  00308
*  //PTFDATA   DD SYSOUT=Y,DCB=(BLKSIZE=3630,RECFM=FBM)                 00309
*  //SYSUDUMP  DD SYSOUT=1                                              00310
         EJECT                                                          00311
         PRINT NOGEN                                                    00312
         IHADECB                                                        00313
BSAMADDR DS    F                                                        00314
BSAMSIZE DS    H                                                        00315
RDCOUNT  DS    H                                                        00316
BSAMSW   DS    X                                                        00317
FIRSTWT  EQU   1                                                        00318
LASTWT   EQU   2                                                        00319
PTREND   DS    0F                                                       00320
         ORG   DECB                                                     00321
WORKAREA DS    F                                                        00322
ESIZE    DS    F                                                        00323
LOWENTRY DS    F                                                        00324
ENDENTRY DS    F                                                        00325
TSTART   DS    X                                                        00326
         ORG                                                            00327
PTRSIZE  EQU   PTREND-DECB                                              00328
DSSIZE   EQU   PTRSIZE+2*PREFIX                                         00329
BSAMAREA DSECT                                                          00330
BSAMLINK DS    F                                                        00331
BSAMBUFE DS    F                                                        00332
BSAMBUFC DS    F                                                        00333
BSAMBUF  DS    38CL80                                                   00334
PREFIX   EQU   BSAMBUF-BSAMAREA                                         00335
LISTNAME DSECT                                                          00336
LNAME    DS    7C                                                       00337
LSW      DS    C                                                        00338
RECDATA  DSECT                                                          00339
REC      DS    80X                                                      00340
         IHASTOW                                                        00341
STOWEND  EQU   *                                                        00342
STOWSIZE EQU   STOWEND-STOW                                             00343
         EJECT                                                          00344
PHRANQUE CSECT                                                          00345
         STM   R14,R12,12(R13)                                          00346
         LR    R12,R15                                                  00347
         USING PHRANQUE,R12                                             00348
         USING DECB,R8                                                  00349
         USING LNAME,R4                                                 00350
         USING IHADCB,R2                                                00351
         USING REC,R3                                                   00352
         USING BSAMAREA,R11                                             00353
         L     R4,ASAVE           ADDR OF SAVE AREA                     00354
         ST    R13,4(R4)          SAVE BACK POINTER                     00355
         ST    R4,8(R13)          SAVE FORWARD POINTER                  00356
         LR    R13,R4             NEW SAVE AREA                         00357
         LR    R4,R1              SAVE PARM REG                         00358
         USING SAVE,R13                                                 00359
         OPEN  MF=(E,ODDS)                                              00360
         LA    R10,OPTIONS        SET RETURN FROM SPACES                00361
         L     R1,0(R4)           POINTER TO PARM DATA                  00362
         LH    R2,0(R1)           LENGTH OF PARM DATA                   00363
         LTR   R2,R2              ZERO LENGTH?                          00364
         BZ    NOPARMS            YES, NO EXEC CARD PARMS               00365
         C     R2,=F'100'         LENGTH CHECK                          00366
         BH    ERROR12            CAN'T BE OVER 100                     00367
         BCTR  R2,0               MINUS ONE FOR MOVE                    00368
         EX    R2,MOVEPARM        DO MOVE                               00369
         BAL   R6,PTPARM          FIND FIRST KEYWORD                    00370
         LA    R6,ERECORD         END OF NORMAL RECORD                  00371
         ST    R6,RECEND             SAVE FOR COMPARES                  00372
         MVI   RECORD,C' '        CLEAR                                 00373
         MVC   RECORD+1(119),RECORD     RECORD AREA                     00374
NOPARMS  EQU   *                                                        00375
         RDJFCB MF=(E,OSYSIN)                                           00376
         LTR   R15,R15            SYSIN DD PROVIDED?                    00377
         BNZ   SYSINEOF           NO, TAKE DEFAULTS                     00378
         OPEN MF=(E,OSYSIN),TYPE=J                                      00379
         OI    SW3,SYINOPEN       INDICATE SYSIN OPEN                   00380
         BALR  R6,0               RETURN ADDR FOR GET                   00381
         GET   SYSIN,RECORD                                             00382
PTPARM   EQU   *                                                        00383
         LA    R0,PRECORD         ADDR OF PRINT RECORD                  00384
         BAL   R14,MPRINT         LINK TO SYSPRINT RTN                  00385
         CLI   RECORD,C'*'        IS THIS A COMMENT?                    00386
         BER   R6                 YES, GET ANOTHER RECORD               00387
         LA    R3,RECORD          ADDR OF RECORD                        00388
         B     SPACES1                                                  00389
MOVEPARM MVC   RECORD(0),2(R1)    MOVE PARMS TO RECORD AREA             00390
         EJECT                                                          00391
OPTIONS  EQU   *                                                        00392
         CLC   REC(5),=C'BLOCK'   BLOCK PRINT REQUIRED?                 00393
         BE    SETBLOCK                                                 00394
         CLC   REC(7),=C'EXCLUDE' IS THIS AN EXCLUDE LIST?              00395
         BE    SETEX                                                    00396
         CLC   REC(5),=C'NOMOD'   ARE MODULES WANTED?                   00397
         BE    SETNOMOD           NO, GO SET THAT                       00398
         CLC   REC(4),=C'SORT'    SORT ALSO?                            00399
         BE    SETSORT            YES,GO SET UP FOR IT                  00400
         CLC   REC(7),=C'INCLUDE'                                       00401
         BE    SETLIST            YES, PROCESS THE LIST                 00402
         CLC   REC(5),=C'EJECT'     SKIP TO ONE BETWEEN SYSMODS?        00403
         BE    SETEJECT                                                 00404
         CLC   REC(7),=C'NOMERGE'    INHIBIT READBACK?                  00405
         BE    SETNMRGE           YES, SET NOMERGE                      00406
         CLC   REC(7),=C'PTFLIST' IS A PTF LIST REQUESTED?              00407
         BE    STPTFLST           YES, GO SET IT                        00408
         CLC   REC(4),=C'XREF'    IS AN ELEMENT-SYSMOD XREF REQUESTED?  00409
         BE    SETXREF            YES, GO SET IT                        00410
         CLC   REC(5),=C'LINES'   CHANGE PAGE SIZE?                     00411
         BE    SETLINES           YES, DO CHANGE                        00412
         CLC   REC(8),=C'FMIDLIST' IS AN FMID LIST REQUESTED?           00413
         BE    SETFLIST           YES, GO SET IT                        00414
         CLC   REC(6),=C'HEADER'   IS AN HEADER REQUESTED?              00415
         BE    SETHEADR           YES, GO SET IT                        00416
         CLC   REC(7),=C'SYSMODS'  CHANGE SYSMOD COUNT?                 00417
         BE    SETSYSMD           YES, CHANGE IT                        00418
         CLC   REC(3),=C'END'     END OF CONTROL STATEMENTS?            00419
         BE    SYSINEOF           YES, GO TO EOF ON SYSIN               00420
         B     ERROR1             UNKNOWN KEYWORD                       00421
ASAVE    DC    A(PHRA0003)                                              00422
         EJECT                                                          00423
SETLINES EQU   *                                                        00424
         TM    SW4,LINES          DUPLICATE KEYWORD?                    00425
         BO    ERROR5             YES, ERROR                            00426
         OI    SW4,LINES          SET LINES PROCESSED                   00427
         LA    R3,5(R3)           BUMP OVER KEYWORD                     00428
         BAL   R8,CVB             LINK TO BINARY CONVERT                00429
         ST    R15,MAXLINES       NEW PAGE SIZE                         00430
         ST    R15,LCOUNT         FORCE NEW PAGE                        00431
         B     SPACES                                                   00432
         SPACE 3                                                        00433
CVB      EQU *                                                          00434
         ST    R10,SAVER10        SAVE BAL REG                          00435
         BAL   R10,SPACES         SKIP OVER SPACES                      00436
         CLI   REC,C'='           EQUAL SIGN?                           00437
         BE    FOREQU             PROCESS EQUAL SIGN FORMAT             00438
         CLI   REC,C'('           SYNTAX CHECK                          00439
         BNE   ERROR6             NO, ?                                 00440
         BAL   R4,DOCONV          DO BINARY CONVERT                     00441
         CLI   REC,C')'           IS IT ?                               00442
         BNE   ERROR6             NO, ?                                 00443
         LA    R3,1(R3)           BUMP OVER IT                          00444
CVBRETRN EQU   *                                                        00445
         L     R10,SAVER10        RESTORE R10                           00446
         BR    R8                                                       00447
FOREQU   EQU   *                                                        00448
         BAL   R4,DOCONV          DO BINARY CONVERT                     00449
         B     CVBRETRN                                                 00450
DOCONV   EQU   *                                                        00451
         LA    R3,1(R3)           BUMP POINTER                          00452
         BAL   R11,SCANRTN1       FIND OPERAND AND LENGTH               00453
         C     R5,=F'7'           OPERAND OVER 7 CHARACTERS?            00454
         BH    ERROR6             YES, SYSTAX ERROR                     00455
         LR    R15,R5             SAVE LENGTH FOR NUMERIC SCAN          00456
TESTNUM  EQU   *                                                        00457
         BCTR  R15,0              DECREMENT INDEX REG                   00458
         TM    REC,X'F0'          IS IT NUMERIC ?                       00459
         BNO   ERROR6             IF NOT, SYNTAX ERROR                  00460
         LA    R3,1(R3)           BUMP RECORD POINTER                   00461
         LTR   R15,R15            END OF SCAN ?                         00462
         BNZ   TESTNUM            NO, CONTINUE SCAN                     00463
         SR    R3,R5              RESTORE RECORD POINTER                00464
         LR    R15,R5             SAVE LENGTH AGAIN                     00465
         BCTR  R5,0               DECREMENT FOR PACK                    00466
         O     R5,=F'112'         OR IN L1 FOR PACK                     00467
         EX    R5,PACKIT          EXECUTE PACK                          00468
         AR    R3,R15             SKIP OVER OPERAND                     00469
         BAL   R10,SPACES         LOOK FOR )                            00470
         CVB   R15,PACKDEC        CONVERT TO BINARY                     00471
         BR    R4                                                       00472
PACKIT   PACK  PACKDEC(0),REC(0)  EXECUTED PACK                         00473
         EJECT                                                          00474
SETSYSMD EQU   *                                                        00475
         TM    SW2,SYSMOD         DUPLICATE KEYWORD                     00476
         BO    ERROR5             YES, ERROR                            00477
         OI    SW2,SYSMOD         SET CHANGE SYSMOD COUNT               00478
         LA    R3,7(R3)           BUMP OVER KEYWORD                     00479
         BAL   R8,CVB             LINK TO BINARY CONVERT                00480
         ST    R15,SMCOUNT        SET NEW COUNT                         00481
         B     SPACES                                                   00482
         SPACE 3                                                        00483
SETHEADR EQU   *                                                        00484
         TM    SW2,PHEADER        CHECK FOR DUPLICATE PARM              00485
         BO    ERROR5                                                   00486
         L     R1,BLOCKPT         ADDR OF BLOCK PRINT RTN               00487
         LTR   R1,R1              IS BLOCK PRINT RTN LINKED?            00488
         BZ    ERROR13            NO, ERROR                             00489
         OI    SW2,PHEADER        INDICATE PRINT HEADER                 00490
         ST    R10,SAVER10        SAVE BAL REG                          00491
         MVC   IMSG3(8),=8C' '    CLEAR STOW NAME                       00492
         LA    R3,6(R3)           BUMP POINTER                          00493
         BAL   R10,SPACES         STEP TO HEADER DATA                   00494
         CLI   REC,C'='           FORMAT EQUAL SIGN?                    00495
         BE    HEADEQU            YES, DO THAT FORMAT                   00496
         CLI   REC,C'('           OTHER FORMAT?                         00497
         BNE   ERROR6             NO, WHO KNOWS?                        00498
         BAL   R4,MOVECHRS        MOVE HEADER DATA TO STOW NAME         00499
         CLI   REC,C')'           CLOSING THING?                        00500
         BNE   ERROR6             NO, ERROR                             00501
         LA    R3,1(R3)           BUMP OVER IT                          00502
CHRSEXIT EQU   *                                                        00503
         L     R10,SAVER10        RESTORE BAL REG                       00504
         B     SPACES                                                   00505
HEADEQU  EQU   *                                                        00506
         BAL   R4,MOVECHRS        MOVE HEADER DATA TO STOW NAME         00507
         B     CHRSEXIT                                                 00508
MOVECHRS EQU   *                                                        00509
         LA    R3,1(R3)           BUMP OVER DELIMITER                   00510
         BAL   R11,SCANRTN1       DO SPACES AND LENGTH                  00511
         LTR   R5,R5              ZERO LENGTH?                          00512
         BZ    HEADROFF           YES,TURN OFF HEADER                   00513
         C     R5,=F'7'           7 CHARACTERS MAX                      00514
         BH    ERROR6             TOO MANY IS AN ERROR                  00515
         LR    R15,R5             SAVE LENGTH                           00516
         BCTR  R5,0               MINUS ONE FOR EXECUTE                 00517
         EX    R5,MVECHARS        DO MOVE                               00518
         AR    R3,R15             BUMP OVER HEADER DATA                 00519
HEADER1  EQU   *                                                        00520
         BAL   R10,SPACES         DO SPACES STUFF                       00521
         BR    R4                                                       00522
HEADROFF EQU   *                                                        00523
         NI    SW2,255-PHEADER    RESET PHEADER                         00524
         B     HEADER1                                                  00525
MVECHARS MVC   IMSG3(0),REC                                             00526
         EJECT                                                          00527
SETEX    EQU   *                                                        00528
         TM    SW,EXCLUDE         CHECK FOR DUPLICATE PARM              00529
         BO    ERROR5                                                   00530
         OI    SW,EXCLUDE         SET EXCLUDE                           00531
         B     SETLIST                                                  00532
         SPACE 3                                                        00533
SETBLOCK EQU   *                                                        00534
         TM    SW3,BLOCK          DUPLICATE KEYWORD?                    00535
         BO    ERROR5             YES, ERROR                            00536
         L     R1,BLOCKPT         ADDR OF BLOCK PRINT RTN               00537
         LTR   R1,R1              IS IT LINKED?                         00538
         BZ    ERROR13            NO, ERROR                             00539
         OI    SW3,BLOCK                                                00540
         LA    R3,5(R3)                                                 00541
         B     SPACES                                                   00542
         SPACE 3                                                        00543
SETSORT  EQU   *                                                        00544
         TM    SW,SORT            HAVE WE ALREADY SELECTED SORT?        00545
         BO    ERROR5             YES, DUPLICATE KEYWORD                00546
         RDJFCB MF=(E,OSYSUT2)                                          00547
         LTR   R15,R15            RETURN CODE ZERO?                     00548
         BNZ   ERROR10                                                  00549
         OI    SW,SORT            SET SORT SW                           00550
         OPEN  MF=(E,OSYSUT2),TYPE=J                                    00551
         OPEN  MF=(E,OUT2DIR)                                           00552
         L     R15,APUTUT2        ADDR OF PUT RTN                       00553
         ST    R15,APUTRTN        STORE IN ADDR LIST                    00554
         LA    R2,SYSUT2          DCB ADDR                              00555
         LA    R8,ABSAMUT2        ADDR OF BSAM POINTER                  00556
         BAL   R7,GETBUF          GET AND SET UP BUFFER                 00557
         OI    SW2,UT2OPEN        SYSUT2 HAS BEEN OPENED                00558
         LA    R3,4(R3)           BUMP POINTER                          00559
         B     SPACES                                                   00560
APUTUT2  DC    A(PUTUT2)                                                00561
         SPACE 2                                                        00562
         EJECT                                                          00563
SETLIST  EQU   *                                                        00564
         TM    SW,LIST            HAVE WE ALREADY PROCESSED A LIST?     00565
         BO    ERROR5             YES, DUPLICATE KEYWORD                00566
         OI    SW3,DOSCAN         SCAN LIST AT END                      00567
         OI    SW,LIST            SET LIST SW                           00568
         ST    R10,SAVER10        SAVE BAL REG                          00569
         LA    R3,7(R3)           BUMP POINTER                          00570
         BAL   R10,SPACES         SKIP OVER SPACES                      00571
         CLI   REC,C'='           CHANGE TABLE SIZE ?                   00572
         BNE   DOPTFLST           NO, BUILD TABLE                       00573
         BAL   R4,DOCONV          CONVERT NEW TABLE SIZE                00574
         ST    R15,APTFLIST       NEW SIZE                              00575
DOPTFLST EQU   *                                                        00576
         CLI   REC,C'('           IS THIS A LIST?                       00577
         BNE   ERROR6             NO, WHO KNOWS?                        00578
         LA    R1,8               ENTRY SIZE                            00579
         M     R0,APTFLIST        GETMAIN SIZE                          00580
         LR    R8,R1              SAVE LENGTH                           00581
         GETMAIN R,LV=(R1),SP=10                                        00582
         ST    R1,APTFLIST        ADDR OF PTF LIST                      00583
         LR    R4,R1                                                    00584
         LA    R8,0(R1,R8)        END OF LIST                           00585
ADD1     EQU   *                                                        00586
         LA    R3,1(R3)           BUMP RECORD POINTER                   00587
         BAL   R10,SPACES         SKIP OVER BLANK CHARACTERS            00588
         CLI   REC,C')'           END OF LIST?                          00589
         BE    ENDLIST            YES, RETURN                           00590
         BAL   R10,LENGTH         GET LENGTH OF THIS PARM               00591
         LA    R10,7              LENGTH MUST BE 7                      00592
         CLR   R10,R5             ARE THEY EQUAL?                       00593
         BNE   ERROR2             NO, DO ERROR MSG                      00594
         CR    R8,R4              TABLE FULL?                           00595
         BNH   ERROR7             YEP                                   00596
         MVC   0(7,R4),REC        MOVE SYSMOD NAME TO TABLE             00597
         MVI   7(R4),X'00'        ZERO COUNTER                          00598
         LA    R4,8(R4)           BUMP LIST POINTER                     00599
         LA    R3,6(R3)           BUMP RECORD POINTER                   00600
         B     ADD1               LOOP BACK                             00601
ENDLIST  EQU   *                                                        00602
         ST    R4,ENDPTFL         SAVE END POINTER                      00603
         L     R10,SAVER10        RESTORE BAL REG                       00604
         LA    R3,1(R3)           BUMP RECORD POINTER                   00605
         B     SPACES                                                   00606
         SPACE 3                                                        00607
SETNMRGE EQU   *                                                        00608
         TM    SW3,NOMERGE        DUPLICATE KEYWORD?                    00609
         BO    ERROR5             YES, MSG AND EXIT                     00610
         OI    SW3,NOMERGE        SET NOMERGE                           00611
         LA    R3,7(R3)                                                 00612
         B     SPACES                                                   00613
         EJECT                                                          00614
SETNOMOD EQU   *                                                        00615
         TM    SW,NOMOD           HAVE WE ALREADY SELECTED NOMOD?       00616
         BO    ERROR5             YES, DUPLICATE KEYWORD                00617
         RDJFCB MF=(E,OSYSUT1)                                          00618
         LTR   R15,R15            RETURN CODE ZERO?                     00619
         BNZ   ERROR11                                                  00620
         OI    SW,NOMOD           SET NOMOD SW                          00621
         OPEN  MF=(E,OSYSUT1),TYPE=J                                    00622
         LA    R2,SYSUT1          DCB ADDR                              00623
         LA    R8,ABSAMUT1        ADDR OF BSAM POINTER                  00624
         BAL   R7,GETBUF          GET AND SET UP BUFFER                 00625
         OI    SW2,UT1OPEN        SYSUT1 HAS BEEN OPENED                00626
         L     R1,NAMELIST        LIST SIZE                             00627
         LR    R8,R1              SAVE LENGTH                           00628
         GETMAIN R,LV=(R1),SP=10                                        00629
         ST    R1,NAMELIST        ADDR OF ELEMENT LIST                  00630
         LA    R8,0(R1,R8)        END OF LIST                           00631
         ST    R8,ENDNAMEL        END OF ELEMENT LIST                   00632
         LA    R3,5(R3)           BUMP POINTER                          00633
         B     SPACES                                                   00634
         SPACE 3                                                        00635
SETEJECT EQU   *                                                        00636
         TM    SW3,EJECT          DUPLICATE PARM?                       00637
         BO    ERROR5             YES, ERROR MSG                        00638
         OI    SW3,EJECT          SET EJECT                             00639
         LA    R3,5(R3)                                                 00640
         B     SPACES                                                   00641
         SPACE 3                                                        00642
SETXREF  EQU   *                                                        00643
         TM    SW3,XREF           DUPLICATE KEYWORD?                    00644
         BO    ERROR5             YES, ERROR                            00645
         OI    SW3,XREF           SET XREF                              00646
         LA    R3,4(R3)           BUMP POINTER                          00647
         B     SPACES                                                   00648
         SPACE 3                                                        00649
STPTFLST EQU   *                                                        00650
         TM    SW3,PTFLIST        DUPLICATE KEYWORD?                    00651
         BO    ERROR5             YES, ERROR                            00652
         OI    SW3,PTFLIST        SET PTFLIST                           00653
         LA    R3,7(R3)           BUMP POINTER                          00654
         B     SPACES                                                   00655
         SPACE 3                                                        00656
SETFLIST EQU   *                                                        00657
         TM    SW4,FMIDLIST       DUPLICATE PARM?                       00658
         BO    ERROR5             YES, ERROR                            00659
         OI    SW4,FMIDLIST       INDICATE BUILD LIST                   00660
         LA    R3,8(R3)           BUMP OVER KEYWORD                     00661
         B     SPACES                                                   00662
         EJECT                                                          00663
SETUPTBL EQU   *                                                        00664
         L     R15,0(R8)          CLACULATE                             00665
         M     R14,SMCOUNT          GETMAIN                             00666
         MR    R14,R11                SIZE                              00667
         LA    R14,16(R15)        ADD 16 BYTES FOR HEADER               00668
         GETMAIN R,LV=(R14),SP=10                                       00669
         ST    R1,0(R8)           SAVE TABLE ADDR                       00670
         LR    R8,R1              BASE FOR TABLE                        00671
         AR    R14,R1             END OF TABLE                          00672
         ST    R14,ENDENTRY       LAST TABLE POSITION                   00673
         SR    R14,R11            BACK UP ONE                           00674
         ST    R14,LOWENTRY       ADDR OF LOWEST ENTRY                  00675
         BCTR  R11,0              ENTRY SIZE MINUS 1                    00676
         ST    R11,ESIZE          SAVE IT                               00677
         EX    R11,CLRENTRY       MAKE LOW ENTRY ZEROS                  00678
         BR    R7                                                       00679
CLRENTRY XC    0(0,R14),0(R14)                                          00680
         SPACE 3                                                        00681
SYSINEOF EQU   *                                                        00682
         TM    SW3,XREF           BUILD XREF?                           00683
         BZ    NOTXREF            NO, TRY PTFLIST                       00684
         LA    R8,XREFADDR        ADDR OF XREF TABLE                    00685
         LA    R11,16             ENTRY SIZE                            00686
         BAL   R7,SETUPTBL        GET STORAGE AND INITIALIZE TABLE      00687
NOTXREF  EQU   *                                                        00688
         TM    SW3,PTFLIST        BUILD PTFLIST?                        00689
         BZ    NOTPTFL            NO, TRY FMIDLIST                      00690
         LA    R8,TADDR           ADDR OF PTFLIST TABLE                 00691
         LA    R11,8              ENTRY SIZE                            00692
         BAL   R7,SETUPTBL        GET STORAGE AND INITIALIZE TABLE      00693
NOTPTFL  EQU   *                                                        00694
         TM    SW4,FMIDLIST       BUILD FMIDLIST?                       00695
         BZ    NOTFMIDL           NO,MOVE ON                            00696
         LA    R8,FMIDADDR        FMID LIST TABLE                       00697
         LA    R11,16             ENTRY SIZE                            00698
         BAL   R7,SETUPTBL        BUILD FMID TABLE                      00699
NOTFMIDL EQU   *                                                        00700
         TM    SW3,SYINOPEN       IS SYSIN OPEN?                        00701
         BZ    NOSYSIN            NO, DO NOT CLOSE                      00702
         CLOSE MF=(E,OSYSIN)                                            00703
         FREEPOOL SYSIN                                                 00704
NOSYSIN  EQU   *                                                        00705
         CALL  PHRA0001                                                 00706
SYSIN    DCB   DDNAME=SYSIN,DSORG=PS,EODAD=SYSINEOF,LRECL=80,          X00707
               MACRF=GM,RECFM=F,BLKSIZE=80,EXLST=XLIST                  00708
OSYSIN   OPEN  (SYSIN,INPUT),MF=L                                       00709
         EJECT                                                          00710
         LTORG                                                          00711
         EJECT                                                          00712
PHRA0001 CSECT                                                          00713
         BALR  R12,0                                                    00714
         USING *,R12                                                    00715
         BAL   R4,HEADERTN        LINK TO HEADER RTN                    00716
         RDJFCB MF=(E,OPTFOUT)    IS THERE PTFOUT DATASET?              00717
         LTR   R15,R15            RETURN CODE ZERO?                     00718
         BNZ   DONTREAD           NO, DO NOT OPEN                       00719
         TM    SW3,NOMERGE        BYPASS MERGE?                         00720
         BO    NOREAD             YES, NO READBACK                      00721
         TM    JFCBTSDM,JFCSDS    SYSOUT DATA SET ?                     00722
         BO    NOREAD             YES, NO READ                          00723
         TM    JFCBIND2,JFCMOD    DISP = NEW OR MOD?                    00724
         BO    NOREAD             YES, DO NOT READ OUTPUT TAPE          00725
         OI    SW,DISPOLD         PTFOUT DISP=OLD                       00726
NOREAD   EQU   *                                                        00727
         OPEN  MF=(E,OPTFOUT),TYPE=J                                    00728
         OI    SW2,OUTOPEN                                              00729
         LA    R2,PTFOUT          DCB ADDR                              00730
         LA    R8,ABSAMOUT        ADDR OF BSAM POINTER                  00731
         BAL   R7,GETBUF          GET AND SET UP BUFFER                 00732
         TM    SW,DISPOLD+SORT    SORT AND PTFOUT DISP=OLD?             00733
         BO    READIT             YES, START READING                    00734
         TM    SW,DISPOLD         DISP=OLD BUT NOT SORT?                00735
         BZ    DONTREAD           NO, START WITH PTFIN                  00736
         CLOSE (PTFOUT,LEAVE),TYPE=T  REPOSITION AT END OF DATA SET     00737
         B     DONTREAD                                                 00738
READIT   EQU   *                                                        00739
         BAL   R14,MSG6                                                 00740
         L     R6,APUTRTN         ADDR OF PUT RTN                       00741
         LA    R9,GETOUT          ADDR OF GET RTN                       00742
         L     R8,ABSAMOUT        ADDR OF BSAM POINTERS                 00743
         LA    R7,NEXTPTF         RETURN FOR ++SYSMOD                   00744
         B     INITREAD           DO INITIAL READ                       00745
         EJECT                                                          00746
POUTEOF  EQU   *                                                        00747
         BAL   R6,STOWRTN         DO FINAL STOW                         00748
         CLOSE (PTFOUT,REREAD),TYPE=T                                   00749
         L     R8,ABSAMOUT        ADDR OF BSAM POINTERS                 00750
         L     R11,BSAMADDR       ADDR OF BSAM AREA                     00751
         LA    R14,BSAMBUF        START OF IO AREA                      00752
         ST    R14,BSAMBUFC       MAKE IT CURRENT                       00753
DONTREAD EQU   *                                                        00754
         BAL   R14,MSG7                                                 00755
         OI    SW,NRDBACK                                               00756
         NI    SW,255-HEADER-PTFSEL                                     00757
         LA    R9,GETPTF          ADDR OF GET ROUTINE                   00758
         LR    R6,R9              LOOP TO GET IF NOT ++                 00759
         RDJFCB MF=(E,OPUNCH)                                           00760
         LTR   R15,R15            WAS IT SUCCESSFUL?                    00761
         BNZ   NOPUNCH            NO, DONT OPEN                         00762
         OPEN  MF=(E,OPUNCH),TYPE=J                                     00763
         LA    R6,PUTPUNCH        ADDR OF PUNCH RTN                     00764
         OI    SW2,PUNOPEN        INDICATE SYSPUNCH OPEN                00765
NOPUNCH  EQU   *                                                        00766
         BALR  R7,R9              LINK TO INPUT ROUTINE                 00767
NEXTPTF  EQU   *                                                        00768
         BAL   R6,CKPTF           FINISH UP THIS SYSMOD                 00769
         LR    R6,R9              SET UP RETURN REG                     00770
         NI    SW,255-HEADER-PTFSEL                                     00771
         AR    R3,R5              BUMP RECORD POINTER                   00772
         BAL   R11,SCANRTN        FIND NEXT DATA WORD                   00773
         TM    SW,LIST+NRDBACK    LIST AND NOT READING PTFOUT?          00774
         BNO   NOLIST             DO LIST ONLY IF BOTH ARE ONE          00775
         BAL   R15,LISTRTN        CHECK PTF LIST                        00776
NOLIST   EQU   *                                                        00777
         L     R4,NAMELIST        ADDR OF ELEMENT LIST                  00778
         ST    R4,CNAMEL          MAKE IT CURRENT                       00779
         OI    SW,PTFSEL          INDICATE THAT A PTF IS SELECTED       00780
         MVC   STOWA(8),=8C' '    CLEAR STOW AREA                       00781
         MVC   STOWA(7),REC       MOVE PTF NUMBER TO MEMBER NAME        00782
         MVC   TEMPNAME+8(8),STOWA SYSMOD NAME FOR XREF TABLE           00783
SETPUT   EQU   *                                                        00784
         L     R6,APUTRTN         ADDR OF PUT RTN                       00785
         BR    R6                 GO DO PUT                             00786
         EJECT                                                          00787
LISTRTN  EQU   *                                                        00788
         L     R4,APTFLIST        ADDR OF PTF LIST                      00789
COMPARE  EQU   *                                                        00790
         CLC   LNAME(7),REC       CHECK FOR MATCH                       00791
         BE    PTFMATCH           YES, SELECT THIS PTF                  00792
         LA    R4,8(R4)           BUMP POINTER                          00793
         CL    R4,ENDPTFL         END?                                  00794
         BC    10,NOMATCH         YES, NOT FOUND                        00795
         B     COMPARE            LOOP BACK                             00796
NOMATCH  EQU   *                                                        00797
         TM    SW,EXCLUDE         IS THIS AN EXCLUDE LIST?              00798
         BZR   R6                 NO, NO PTFSEL                         00799
         BR    R15                                                      00800
PTFMATCH EQU   *                                                        00801
         MVI   LSW,X'01'          MARK AS SELECTED                      00802
         TM    SW,EXCLUDE         IS THIS AN EXCLUDE LIST?              00803
         BOR   R6                 YES, BYPASS THIS SYSMOD               00804
         BR    R15                                                      00805
         SPACE 3                                                        00806
CKPTF    EQU   *                                                        00807
         TM    SW2,INNOMOD        IS PART OF THIS SYSMOD ON SYSUT1?     00808
         BO    RDSYSUT1           YES, GET MOD ELEMENTS FROM SYSUT1     00809
         TM    SW,PTFSEL          IS A PTF SELECTED?                    00810
         BZR   R6                 NO, BYPASS STOW                       00811
         TM    SW,SORT            ARE WE DOING A SORT?                  00812
         BO    STOWRTN            YES, STOW SYSMOD NAME                 00813
         BAL   R14,MSG2           END OF PTF MSG                        00814
DOPLIST  EQU   *                                                        00815
         TM    SW3,PTFLIST        IS PTFLIST TO BE DONE?                00816
         BZR   R6                 NO, RETURN                            00817
         L     R8,TADDR           ADDR OF TABLE                         00818
         LA    R10,STOWA          ADDR OF OBJECT FOR TABLE ADD          00819
         B     TBLSORT            DO ADD TO PTF LIST                    00820
STOWRTN  EQU   *                                                        00821
         L     R8,ABSAMUT2        ADDR OF BSAM POINTERS                 00822
         BAL   R4,CHKWRITE        FINISH UP OUTPUT                      00823
         STOW  SYSUT2,STOWA       STOW THE PTF NUMBER                   00824
CHKSTOW  EQU   *                                                        00825
         B     *+4(R15)           BRANCH TABLE FOR CHECKING STOW        00826
         B     DOPLIST            GOOD STOW, DO TABLE                   00827
         B     DUPNAME            SECOND COPY OF THIS PTF, USE THIS ONE 00828
         B     ERROR9             INVALID STOW REQUEST                  00829
         B     ERROR8             OUT OF DIRECTORY SPACE                00830
DUPNAME  EQU   *                                                        00831
         BAL   R14,MSG1           DUPLICATE PTF MSG                     00832
         STOW  SYSUT2,STOWA,R     DO STOW WITH REPLACE                  00833
         B     CHKSTOW            CHECK RETURN CODE AGAIN               00834
         EJECT                                                          00835
PUTPTF   EQU   *                                                        00836
         TM    SW,HEADER          HAVE WE PRINTED THE HEADER YET?       00837
         BO    COPY               YES, DONT DO IT AGAIN                 00838
         BAL   R10,BLOCKRTN       GO TO BLOCK PRINT RTN                 00839
COPY     EQU   *                                                        00840
         BALR  R6,0               SET UP RETURN FOR NOT ++PTF           00841
         TM    SW4,LISTREC        PRINT THIS REC?                       00842
         BZ    NOPRINT            NO, BR                                00843
         LA    R0,PRECORD         ADDR OF PRINT RECORD                  00844
         BAL   R14,PRINT          LINK TO PRINT ROUTINE                 00845
         TM    SW4,NLISTALL       SHOULD WE LIST ALL?                   00846
         BZ    NOPRINT            YES, BYPASS CHECK FOR PERIOD          00847
         TM    SW4,NCOMMENT       ARE WE IN COMMENT?                    00848
         BZ    CHKCOM             YES, CHECK FOR END OF COMMENT         00849
PERIOD   EQU   *                                                        00850
         CLI   REC,C'.'           END OF STATEMENT?                     00851
         BE    LISTOFF            YES, TURN LIST OFF                    00852
         TM    SW4,NINVER         ARE WE IN A ++VER STATEMENT?          00853
         BO    NOTVER             NO, DO NOT CHECK FMID LIST            00854
         TM    SW4,FMIDPARN+FMIDID WHERE IN FMID STUFF ARE WE?          00855
         BZ    FMID1              ZERO = LOOKING FOR C'FMID'            00856
         BM    FMID2              MIXED = LOOKING FOR C'('              00857
*                                 ONES = LOOKING FOR FUNCTION ID        00858
NOTVER   EQU   *                                                        00859
         CLC   REC(2),=C'/*'      START OF COMMENT?                     00860
         BE    SETCOM             YES, GO SET COMMENT                   00861
PERIOD1  EQU   *                                                        00862
         TM    SW4,FMIDPARN+FMIDID ARE WE LOOKING FOR FUNCTION ID ?     00863
         BNO   PERIOD2            NO, CONTINUE NORMAL SCAN              00864
         CLI   REC,C' '           IS THIS CHARACTER A BLANK?            00865
         BNE   FMID3              NO, THEN IT IS FUNCTION ID            00866
PERIOD2  EQU   *                                                        00867
         LA    R3,1(R3)           NEXT CHARACTER                        00868
         C     R3,RECEND          END OF RECORD?                        00869
         BC    10,NOPRINT         YES, MOVE ON                          00870
         B     PERIOD                                                   00871
SETCOM   EQU   *                                                        00872
         NI    SW4,255-NCOMMENT      SET IN COMMENT                     00873
         B     CHKCOM1                                                  00874
CHKCOM   EQU   *                                                        00875
         CLC   REC(2),=C'*/'      END OF COMMENT?                       00876
         BE    RESETCOM           YES,GO CHECK FOR PERIOD               00877
CHKCOM1  EQU   *                                                        00878
         LA    R3,1(R3)           NEXT CHARACTER                        00879
         C     R3,RECEND          END OF RECORD?                        00880
         BC    10,NOPRINT         YES, MOVE ON                          00881
         B     CHKCOM                                                   00882
RESETCOM EQU   *                                                        00883
         OI    SW4,NCOMMENT       SET NOT IN COMMENT                    00884
         B     PERIOD1                                                  00885
LISTOFF  EQU   *                                                        00886
         NI    SW4,255-LISTREC    TURN OFF LIST AND VER                 00887
NOPRINT  EQU   *                                                        00888
         L     R4,RECCOUNT        INCREMENT                             00889
         LA    R4,1(R4)           RECORD                                00890
         ST    R4,RECCOUNT        COUNT                                 00891
         TM    SW2,OUTOPEN        IS PTFOUT OPEN?                       00892
         BZR   R9                 NO, DO NOT WRITE                      00893
         L     R8,ABSAMOUT        ADDR OF BSAM POINTERS                 00894
         BAL   R10,BSAMWRIT       PUT RECORD TO PTFOUT                  00895
         BR    R9                                                       00896
         EJECT                                                          00897
FMID1    EQU   *                                                        00898
         CLC   REC(4),=C'FMID'    IS THIS FMID KEYWORD ?                00899
         BNE   NOTVER             NO, CONTINUE LOOKING                  00900
         LA    R3,3(R3)           BUMP POINTER L'FMID-1                 00901
         OI    SW4,FMIDID         HAVE FOUND C'FMID'                    00902
         B     NOTVER                                                   00903
         SPACE 3                                                        00904
FMID2    EQU   *                                                        00905
         CLI   REC,C'('           IS THIS C'(' AFTER C'FMID'            00906
         BNE   NOTVER             NO, CONTINUE LOOKING                  00907
         OI    SW4,FMIDPARN+NINVER HAVE FOUND C'('--- ALSO              00908
*                                 SET 'NOT IN VER STATEMENT' --         00909
*                                 DON'T NEED TO DO THAT CHECKING NOW    00910
         B     PERIOD2                                                  00911
         SPACE 3                                                        00912
FMID3    EQU   *                                                        00913
         MVC   TEMPNAME(7),REC    MOVE FMID FOR TABLE                   00914
         MVI   TEMPNAME+7,C' '    PUT BLANK ON END                      00915
         NI    SW4,255-FMIDPARN-FMIDID                                  00916
         ST    R6,SAVER10         SAVE BAL REG                          00917
         L     R8,FMIDADDR        ADDR OF FMID TABLE                    00918
         LA    R10,TEMPNAME       ADDR OF OBJECT FOR TABLE ADD          00919
         BAL   R6,TBLSORT         ADD TO FMID TABLE                     00920
         LA    R3,3(R3)           BUMP POINTER L'FUNCTION-1             00921
         L     R6,SAVER10         RESTORE BAL REG                       00922
         B     NOTVER                                                   00923
         SPACE 3                                                        00924
PUTUT2   EQU   *                                                        00925
         L     R8,ABSAMUT2        ADDR OF BSAM POINTERS                 00926
         BAL   R10,BSAMWRIT                                             00927
         BR    R9                                                       00928
         SPACE 3                                                        00929
TCLOSE   EQU   *                                                        00930
         CLOSE (SYSUT1,REREAD),TYPE=T                                   00931
         BR    R10                                                      00932
         EJECT                                                          00933
UT2EOF   EQU   *                                                        00934
         L     R14,CURDE          ADDR OF CURRENT DIRECTORY ENTRY       00935
         CLC   0(8,R14),KEY       IS THIS END OF DIRECTORY BLOCK?       00936
         BNE   STEPDIR            NO, GET NEXT DIRECTORY ENTRY          00937
STARTDIR EQU   *                                                        00938
         LA    R14,KEY            ADDR OF DIRECTORY BUFFER              00939
         READ  DIRECB,SF,UT2DIR,(R14)                                   00940
         CHECK DIRECB                                                   00941
         LA    R14,DIR            ADDR OF DIRECTORY RECORD              00942
         B     DOPOINT                                                  00943
STEPDIR  EQU   *                                                        00944
         IC    R15,STOCTTRN-STOW(R14)  LENGTH BYTE                      00945
         N     R15,USERL          USE ONLY LENGTH BITS                  00946
         LA    R15,12(R15,R15)    SIZE OF THIS ENTRY                    00947
         AR    R14,R15            ADDR OF NEXT ENTRY                    00948
DOPOINT  EQU   *                                                        00949
         ST    R14,CURDE          ADDR OF CURRENT DIRECTORY ENTRY       00950
         CLC   0(8,R14),=8X'FF'   END OF DIRECTORY?                     00951
         BE    DIREOF             YES, CLEAN UP AND EXIT                00952
         MVC   STOWA(12),0(R14)   MOVE TO STOW AREA                     00953
         NC    STOWA+STOTTR-STOW(L'STOTTR+L'STOCTTRN),TTRMASK           00954
         POINT SYSUT2,STOWA+STOTTR-STOW                                 00955
         L     R8,ABSAMUT2        ADDR OF BSAM POINTERS                 00956
INITREAD EQU   *                                                        00957
         BAL   R10,IREAD          START READ PROCESS                    00958
         B     CHECKREC                                                 00959
         SPACE 3                                                        00960
IREAD    EQU   *                                                        00961
         L     R11,BSAMADDR       ADDR OF BSAM AREA                     00962
         BAL   R4,READ                                                  00963
         B     DOREAD                                                   00964
         EJECT                                                          00965
RDSYSUT1 EQU   *                                                        00966
         L     R8,ABSAMUT1        ADDR OF BSAM POINTERS                 00967
         BAL   R10,BSAMWRIT       OUTPUT CURRENT BUFFER, START NEW ONE  00968
LSTRDUT1 EQU   *                                                        00969
         BAL   R4,CHKWRITE        FINISH UP OUTPUT                      00970
         BAL   R10,TCLOSE         SET TO REREAD SYSUT1                  00971
         ST    R9,AGETRTN         SAVE GET RTN ADDR                     00972
         LA    R9,GETUT1          ADDR OF GET ROUTINE                   00973
         OI    SW2,UT1LOOP        INDICATE READING FROM SYSUT1          00974
         LR    R6,R9              RETURN FOR NOT ++PTF                  00975
         BAL   R7,INITREAD        START READ PROCESS                    00976
ENDUT1LP EQU   *                                                        00977
         L     R8,ABSAMUT1        ADDR OF BSAM POINTERS                 00978
         L     R11,BSAMADDR       CURRENT BSAMAREA                      00979
         BAL   R4,RESETBUF        RESET BUFFER POINTERS                 00980
         CHECK (R8)                                                     00981
UT1EOF   EQU   *                                                        00982
         TM    SW3,EOFPTFIN       IS PTFIN AT EOF?                      00983
         BO    ENDNOMOD           YES, EXIT INPUT PROCESSING            00984
         BAL   R10,TCLOSE         POSITION SYSUT1 FOR REUSE             00985
         NI    SW2,255-INNOMOD-UT1LOOP                                  00986
         L     R9,AGETRTN         RESTORE GET RTN ADDR                  00987
         LA    R7,NEXTPTF                                               00988
         BR    R7                 GO DO NEXT PTF                        00989
         SPACE 3                                                        00990
PTFINEOF EQU   *                                                        00991
         OI    SW3,EOFPTFIN       INDICATE PTFIN AT EOF                 00992
         L     R8,ABSAMUT1        ADDR OF BSAM POINTERS                 00993
         TM    SW2,INNOMOD        IS ANYTHING ON SYSUT1?                00994
         BO    LSTRDUT1           FINISH READING SYSUT1                 00995
ENDNOMOD EQU   *                                                        00996
         NI    SW2,255-INNOMOD-UT1LOOP                                  00997
         BAL   R6,CKPTF           FINISH UP THIS SYSMOD                 00998
         BAL   R6,PRINTLST        BUILD PTF LIST                        00999
         TM    SW,SORT            ARE WE DOING A SORT?                  01000
         BZ    DIREOF1            NO,FINISHED,GO TO END                 01001
         NI    SW,255-LIST-SORT-NOMOD-PTFSEL                            01002
         BAL   R14,RPRINT         SKIP TO ONE                           01003
         LA    R9,GETUT2          ADDR OF NEW GET RTN                   01004
         ST    R9,AGETRTN         SAVE FOR LATTER                       01005
         LA    R6,PUTPTF          ADDR OF NEW PUT RTN                   01006
         ST    R6,APUTRTN         SAVE IT FOR LATTER                    01007
         LA    R7,NEXTPTF         RETURN FOR ++PTF                      01008
         B     STARTDIR                                                 01009
         SPACE 3                                                        01010
DIREOF   EQU   *                                                        01011
         BAL   R6,CKPTF           END MSG IF NECESSARY                  01012
         BAL   R6,PRNTXREF        NOW DO FMIDLIST                       01013
DIREOF1  EQU   *                                                        01014
         CALL  PHRA0002                                                 01015
         EJECT                                                          01016
GETOUT   EQU   *                                                        01017
         L     R8,ABSAMOUT        ADDR OF BSAM POINTERS                 01018
         B     GOREAD                                                   01019
GETUT2   EQU   *                                                        01020
         L     R8,ABSAMUT2        ADDR OF BSAM POINTERS                 01021
         B     GOREAD                                                   01022
GETUT1   EQU   *                                                        01023
         L     R8,ABSAMUT1        ADDR OF BSAM POINTERS                 01024
GOREAD   EQU   *                                                        01025
         BAL   R10,BSAMREAD       GET RECORD FROM BSAM BUFFER           01026
         B     CHECKREC                                                 01027
GETPTF   EQU   *                                                        01028
         GET   PTFIN,RECORD                                             01029
CHECKREC EQU   *                                                        01030
         LA    R3,RECORD          RESET RECORD POINTER                  01031
         CLC   RECORD(2),=C'++'   IS IT ++ CARD?                        01032
         BNER  R6                 NO RETURN                             01033
         OI    SW4,LISTREC+NCOMMENT+NLISTALL+NINVER                     01034
         NI    SW4,255-FMIDPARN-FMIDID                                  01035
         LA    R3,2(R3)           PASS OVER ++                          01036
         BAL   R11,SCANRTN1       FIND NEXT DATA WORD                   01037
         CLC   REC(8),=C'FUNCTION'     IS IT SYSMOD TPYE FUNCTION?      01038
         BER   R7                 YES, PROCESS IT                       01039
         CLC   REC(3),=C'PTF'     IS IT SYSMOD TYPE PTF?                01040
         BER   R7                 YES, PROCESS IT                       01041
         CLC   REC(4),=C'APAR'    IS IT SYSMOD TYPE APAR?               01042
         BER   R7                 YES, PROCESS IT                       01043
         CLC   REC(7),=C'USERMOD' IS IT SYSMOD TYPE USERMOD?            01044
         BER   R7                 YES, PROCESS IT                       01045
         TM    SW,PTFSEL          IS A SYSMOD SELECTED?                 01046
         BNOR  R6                                                       01047
         CLC   REC(2),=C'IF'                                            01048
         BE    SETPUT             YES, BYPASS TABLE STUFF               01049
         CLC   REC(5),=C'JCLIN'   IS THIS A JCLIN STATEMENT?            01050
         BE    DOJCLIN            YES, BYPASS TABLE STUFF               01051
         CLC   REC(3),=C'VER'     IS THIS A VER STATEMENT?              01052
         BE    DOVER              YES, CHECK FOR FMID LIST              01053
         MVC   TEMPNAME(8),=8C' ' CLEAR WORK AREA                       01054
         ST    R3,SAVER10                                               01055
         BAL   R10,LENGTH         GET LENGTH OF ELEMENT TYPE            01056
         AR    R3,R5              BUMP RECORD POINTER                   01057
         BAL   R11,SCANRTN        FIND NEXT DATA WORD                   01058
         BCTR  R5,0               SET UP COUNT FOR EXECUTED MOVE        01059
         EX    R5,MOVE            MOVE ELEMENT NAME TO TABLE            01060
         TM    SW,NOMOD+NRDBACK   NOMOD AND NOT READBACK?               01061
         BNO   BLDXREF            NO, JUST BUILD AN XREF                01062
         L     R3,SAVER10                                               01063
         CLC   REC(3),=C'MOD'     IS IT NMOD?                           01064
         BNE   DOTABLE            NO, DO ADD TO ELEMENT NAME TABLE      01065
         TM    SW2,UT1LOOP        ARE WE READING FROM SYSUT1?           01066
         BO    CHECKTBL           YES, CHECK FOR DUPLICATE SOURCE       01067
         OI    SW2,INNOMOD        INDICATE THAT A ++MOD IS ON SYSUT1    01068
         BALR  R6,0               SET UP RETURN FOR NOT ++PTF           01069
         L     R8,ABSAMUT1        ADDR OF BSAM POINTERS                 01070
         BAL   R10,BSAMWRIT       PUT TO SYSUT1                         01071
         BR    R9                 RETURN                                01072
         EJECT                                                          01073
DOVER    EQU   *                                                        01074
         TM    SW4,FMIDLIST       FMID LIST REQUESTED?                  01075
         BZ    SETPUT             NO, BYPASS TABLE                      01076
         NI    SW4,255-NINVER     SET IN ++VER STATEMENT                01077
         B     SETPUT                                                   01078
         SPACE 3                                                        01079
DOJCLIN  EQU   *                                                        01080
         NI    SW4,255-NLISTALL   LIST ALL UNTIL NEXT ++                01081
         B     SETPUT             GO TO PUT RTN                         01082
         EJECT                                                          01083
DOTABLE  EQU   *                                                        01084
         L     R4,CNAMEL          ELEMENT LIST CURRENT POINTER          01085
         CL    R4,ENDNAMEL        END OF TABLE?                         01086
         BE    ERROR4             YES, TOO MANY ELEMENTS TO DO          01087
         MVC   LNAME(8),TEMPNAME  MOVE ELEMENT NAME TO ELEMENT TABLE    01088
         LA    R4,8(R4)           BUMP POINTER                          01089
         ST    R4,CNAMEL          MAKE IT CURRENT                       01090
BLDXREF  EQU   *                                                        01091
         TM    SW3,XREF           IS XREF TO BE DONE?                   01092
         BZ    SETPUT             NO, BYPASS IT                         01093
         L     R8,XREFADDR        ADDR OF XREF TABLE                    01094
         LA    R10,TEMPNAME       ADDR OF OBJECT FOR TABLE ADD          01095
         BAL   R6,TBLSORT         ADD TO XREF TABLE                     01096
         B     SETPUT             RESTORE PUT RTN ADDR AND DO PUT       01097
MOVE     MVC   TEMPNAME(0),REC                                          01098
         SPACE 3                                                        01099
CHECKTBL EQU   *                                                        01100
         L     R4,NAMELIST        ADDR OF ELEMENT LIST                  01101
CHKLOOP  EQU   *                                                        01102
         CL    R4,CNAMEL          ARE WE AT FIRST EMPTY ENTRY?          01103
         BE    BLDXREF            YES, NOT FOUND, COPY THIS ELEMENT     01104
         CLC   LNAME(8),TEMPNAME  DOES SAME NAME EXIST?                 01105
         BE    SKIPMOD            YES, BYPASS THIS ELEMENT              01106
         LA    R4,8(R4)           BUMP POINTER                          01107
         B     CHKLOOP                                                  01108
         SPACE 3                                                        01109
SKIPMOD  EQU   *                                                        01110
         BAL   R14,MSG9           ISSUE MOD DELETED MSG                 01111
         BAL   R14,MSG10          PUT IT TO PTFDATA ALSO                01112
         LR    R6,R9              SET RETURN FOR NOT ++PTF              01113
         BR    R9                                                       01114
         SPACE 3                                                        01115
PUTPUNCH EQU   *                                                        01116
         LA    R0,SKIP            SKIP TO ONE                           01117
         BAL   R14,MPRINT         SKIP TO ONE                           01118
         BALR  R6,0               RETURN FOR PUTS TO SYSPUNCH           01119
         LA    R0,PRECORD         ADDR OF PRINT RECORD                  01120
         BAL   R14,MPRINT         LINK TO SYSPRINT RTN                  01121
         PUT   SYSPUNCH,RECORD                                          01122
         BALR  R7,R9              RETURN FOR ++SYSMOD, LINK TO GET RTN  01123
         LA    R0,SKIP                                                  01124
         BAL   R14,MPRINT         LINK TO SYSPRINT RTN                  01125
         LA    R7,NEXTPTF         PROCESS ++SYSMOD                      01126
         BR    R7                                                       01127
         EJECT                                                          01128
BLOCKRTN EQU   *                                                        01129
         OI    SW,HEADER          SET HEADER PRINTED                    01130
         TM    SW3,EJECT          SKIP TO ONE REQUIRED?                 01131
         BZ    NOEJECT            NO, CONTINUE                          01132
         BAL   R14,RPRINT         SKIP AND RESET COUNTER                01133
NOEJECT  EQU   *                                                        01134
         TM    SW3,BLOCK          BLOCK PRINT REQUESTED?                01135
         BZ    DOMSG3             WRITE MSG3 AND RETURN                 01136
         L     R1,LCOUNT          CURRENT LINE COUNT                    01137
         A     R1,FOURTEEN        BLOCK PRINT REQUIRES 14 LINES         01138
         CL    R1,MAXLINES        WILL BLOCK PRINT FIT ON PAGE?         01139
         BNH   COUNTOK            YES, CONTINUE                         01140
         OI    LCOUNT,X'FF'       FORCE SKIP TO ONE ON NEXT PRINT       01141
COUNTOK  EQU   *                                                        01142
         BAL   R14,MSG3           START OF PTF MSG                      01143
DOHEADER EQU   *                                                        01144
         MVI   MSGAREA,C' '                                             01145
         MVC   MSGAREA+1(119),MSGAREA   CLEAR TO BLANKS                 01146
         LA    R0,PMSGAREA                                              01147
         BAL   R14,PRINT                                                01148
         LA    R1,1               STARTING COUNT                        01149
         ST    R1,COUNT           SET IT IN THE PARM COUNT FIELD        01150
BLOKLOOP EQU   *                                                        01151
         LA    R1,BLKPARM         ADDR OF PARM LIST                     01152
         L     R15,BLOCKPT        ADDR OF BLOCK PRINT RTN               01153
         BALR  R14,R15                                                  01154
         LA    R0,PMSGAREA                                              01155
         BAL   R14,PRINT                                                01156
         MVI   MSGAREA,C' '                                             01157
         MVC   MSGAREA+1(119),MSGAREA   CLEAR TO BLANKS                 01158
         L     R1,COUNT           CURRENT BLOCK LINE COUNT              01159
         LA    R1,1(R1)           BUMP BY ONE                           01160
         ST    R1,COUNT           SAVE IN BLOCK PARM FOR NEXT LINE      01161
         C     R1,MAXCOUNT        BUT, WAS THAT THE LAST LINE ?         01162
         BL    BLOKLOOP           NO, LOOP TO DO NEXT BLOCK LINE        01163
         LA    R0,PMSGAREA                                              01164
         BAL   R14,PRINT                                                01165
         B     COPY1                                                    01166
DOMSG3   EQU   *                                                        01167
         BAL   R14,MSG3           START OF PTF MSG                      01168
COPY1    EQU   *                                                        01169
         MVC   SKIPNAME(8),STOWA                                        01170
         BR    R10                                                      01171
         EJECT                                                          01172
HEADERTN EQU   *                                                        01173
         TM    SW2,PHEADER        PRINT HEADER PAGES?                   01174
         BZR   R4                 NO, SKIPIT                            01175
         MVC   STOWA(8),IMSG3     MOVE HEADER DATA                      01176
         BAL   R10,DOHEADER       HEADER 1                              01177
         BAL   R10,DOHEADER       HEADER 2                              01178
         BAL   R10,DOHEADER       HEADER 3                              01179
         OI    LCOUNT,X'FF'       FORCE NEW PAGE                        01180
         BAL   R10,DOHEADER       HEADER 1                              01181
         BAL   R10,DOHEADER       HEADER 2                              01182
         BAL   R10,DOHEADER       HEADER 3                              01183
         OI    LCOUNT,X'FF'       FORCE NEW PAGE                        01184
         BR    R4                                                       01185
         EJECT                                                          01186
PRINTLST EQU   *                                                        01187
         TM    SW3,DOSCAN         IS THERE A LIST?                      01188
         BZ    NOSCAN             NO, NO LIST TO SCAN                   01189
         L     R4,APTFLIST        ADDR OF PTF LIST                      01190
         TM    SW,EXCLUDE         IS THIS AN EXCLUDE LIST?              01191
         BZ    SCANLOOP           NO, DO 'NOT FOUND' LIST               01192
         MVC   IMSG5+12(9),=C'EXCLUDED '    MAKT IT EXCLUDED MSG        01193
         BALR  R7,0               SET LOOP ADDR                         01194
         TM    LSW,X'01'          WAS THIS ONE EXCLUDED?                01195
         BZ    LISTED             NO, DO NOT LIST                       01196
         B     NLISTED            YES, PUT OUT EXCLUDED MSG             01197
         USING LNAME,R4                                                 01198
SCANLOOP EQU   *                                                        01199
         BALR  R7,0               SET LOOP ADDR                         01200
         TM    LSW,X'01'          WAS SYSMOD FOUND?                     01201
         BO    LISTED             YES, CHECK NEXT ENTRY                 01202
NLISTED  EQU   *                                                        01203
         MVC   IMSG5+4(7),LNAME      MOVE PTF NUMBER TO MSG             01204
         BAL   R14,MSG5           NOT FOUND MSG                         01205
LISTED   EQU   *                                                        01206
         LA    R4,8(R4)           BUMP POINTER                          01207
         CL    R4,ENDPTFL         END OF LIST?                          01208
         BLR   R7                 NO TRY NEXT ENTRY                     01209
NOSCAN   EQU   *                                                        01210
         TM    SW,SORT            WAS A SORT DONE?                      01211
         BO    DONTSKIP           YES, ALLREADY AT TOP OF PAGE          01212
         BAL   R14,RPRINT         SKIP TO ONE                           01213
DONTSKIP EQU   *                                                        01214
         TM    SW3,PTFLIST        WAS PTF LIST DONE?                    01215
         BZ    PRNTXREF           NO, TRY XREF                          01216
         NI    SW3,255-PTFLIST    DISABLE PTFLIST                       01217
         L     R8,TADDR           ADDR OF TABLE                         01218
         L     R11,ESIZE          ENTRY SIZE MINUS 1                    01219
         LTR   R11,R11            IS ENTRY SIZE ZERO?                   01220
         BZ    PRNTXREF           YES,GO TRY XREF                       01221
         L     R15,LOWENTRY       ADDR OF LOWEST ENTRY                  01222
         LA    R15,8(R15)         SKIP OVER ZEROS                       01223
         ST    R15,LOWENTRY       PUT IT BACK                           01224
         MVC   SKIPNAME(8),=C'PTFLIST '                                 01225
         BALR  R14,0              RETURN FOR LOOP AFTER PRINT           01226
         L     R15,LOWENTRY       ADDR OF LOWEST ENTRY                  01227
         C     R15,ENDENTRY       ARE WE AT END?                        01228
         BE    ENDBLD1            YES,EXIT, THIS LINE EMPTY             01229
         MVI   MSGAREA,C' '       CLEAR                                 01230
         MVC   MSGAREA+1(119),MSGAREA  MSG AREA                         01231
         MVC   MSGAREA+90(8),SKIPNAME LIST NAME TO PRINT LINE           01232
         LA    R1,MSGAREA         PRINT LINE ADDR                       01233
         LA    R11,8              LOOP COUNT                            01234
BLDLOOP  EQU   *                                                        01235
         C     R15,ENDENTRY       AT END?                               01236
         BE    ENDBLD             YES, OUTPUT LAST LINE                 01237
         MVC   0(8,R1),0(R15)     MOVE TO PRINT LINE                    01238
         LA    R1,11(R1)          STEP PRINT POSITION                   01239
         LA    R15,8(R15)         STEP TABLE POINTER                    01240
         BCT   R11,BLDLOOP        LOOP TILL ZERO                        01241
         ST    R15,LOWENTRY       PUT IT BACK                           01242
         LA    R0,PMSGAREA        ADDR OF PRINT LINE                    01243
         B     PRINT              DO PRINT                              01244
ENDBLD   EQU   *                                                        01245
         LA    R0,PMSGAREA        ADDR OF PRINT LINE                    01246
         BAL   R14,PRINT          PRINT LAST LINE                       01247
ENDBLD1  EQU   *                                                        01248
         BAL   R14,RPRINT         SKIP TO ONE                           01249
         EJECT                                                          01250
PRNTXREF EQU   *                                                        01251
         ST    R6,SAVER10         SAVE BAL REG                          01252
         TM    SW3,XREF           WAS XREF DONE?                        01253
         BZ    XREF1              NO, TRY FMID LIST                     01254
         NI    SW3,255-XREF       DISABLE XREF                          01255
         L     R8,XREFADDR        ADDR OF XREF TABLE                    01256
         L     R11,ESIZE          ENTRY SIZE MINUS 1                    01257
         LTR   R11,R11            IS IT ZERO?                           01258
         BZ    XREF1              YES, TRY FMID LIST                    01259
         MVC   SKIPNAME(8),=C'XREF    ' NEW LIST NAME                   01260
         BAL   R6,PRINTBL         PRINT XREF TABLE                      01261
XREF1    EQU   *                                                        01262
         TM    SW,SORT            DID WE DO A SORT?                     01263
         BO    XREF3              YES, DONT DO FMIDLIST YET             01264
         TM    SW4,FMIDLIST       IS THERE AN FMID LIST?                01265
         BZ    XREF2              NO RETURN                             01266
         NI    SW4,255-FMIDLIST                                         01267
         L     R8,FMIDADDR        ADDR OF FMID TABLE                    01268
         L     R11,ESIZE          ENTRY SIZE                            01269
         LTR   R11,R11            IS IT ZERO                            01270
         BZ    XREF2              YES, BYPASS PRINT                     01271
         MVC   SKIPNAME(8),=C'FMIDLIST' NEW LIST NAME                   01272
         BAL   R14,RPRINT         SKIP TO ONE                           01273
         BAL   R6,PRINTBL         PRINT FMID TABLE                      01274
XREF2    EQU   *                                                        01275
         OI    LCOUNT,X'FF'       FORCE NEW PAGE                        01276
         BAL   R4,HEADERTN        TRY ENDING HEADER                     01277
XREF3    EQU   *                                                        01278
         L     R6,SAVER10         RESTORE BAL REG                       01279
         BR    R6                                                       01280
         EJECT                                                          01281
PRINTBL  EQU   *                                                        01282
         LA    R4,2               START FOR ADD LINES                   01283
         ST    R4,PACKDEC+4       SAVE IT                               01284
         SR    R4,R4                                                    01285
         ST    R4,WORKAREA        ASSUME ZERO TO START SCAN             01286
         L     R15,LOWENTRY       ADDR OF LOWEST ENTRY                  01287
         LA    R15,16(R15)        SKIP OVER ZEROS                       01288
         ST    R15,LOWENTRY       PUT IT BACK                           01289
         BALR  R14,0              RETURN FROM PRINT                     01290
         MVI   MSGAREA,C' '       CLEAR                                 01291
         MVC   MSGAREA+1(119),MSGAREA  MSGAREA                          01292
         MVC   MSGAREA+90(8),SKIPNAME LIST NAME TO PRINT LINE           01293
         MVI   MSGAREA+28,C'*'                                          01294
         MVI   MSGAREA+58,C'*'                                          01295
         L     R4,WORKAREA        ARE WE IN ADD LINES?                  01296
         SRL   R4,1               NO ADD IF COUNT 0 OR 1                01297
         LTR   R4,R4                                                    01298
         BNZ   ADDLINE            YES, ADD THEM                         01299
         L     R15,LOWENTRY       ADDR OF LOWEST ENTRY                  01300
         C     R15,ENDENTRY       ARE WE AT THE END?                    01301
         BER   R6                 YES, EXIT                             01302
         ST    R15,PACKDEC        SAVE LOWENTRY FOR ADDLINE             01303
         LA    R1,MSGAREA         ADDR FOR MOVE                         01304
         BAL   R10,CHKDUP         SCAN FOR MULTIPLE ENTRIES             01305
         LA    R1,MSGAREA+30      ADDR FOR MOVE                         01306
         BAL   R10,CHKDUP         SCAN FOR MULTIPLE ENTRIES             01307
         LA    R1,MSGAREA+60      ADDR FOR MOVE                         01308
         BAL   R10,CHKDUP         SCAN FOR MULTIPLE ENTRIES             01309
PASSCOMP EQU   *                                                        01310
         ST    R15,LOWENTRY       NEW LOWEST ENTRY                      01311
         L     R4,WORKAREA        GET MAXIMUM DUP COUNT                 01312
         LA    R4,1(R4)           ADD 1 IN CASE COUNT IS ODD            01313
         SRL   R4,1               DIVIDE BY 2 (2 ENTRIES/LINE)          01314
         A     R4,LCOUNT          PLUS CORRENT PRINT LINE COUNT         01315
         CL    R4,MAXLINES        WILL THEY ALL FIT ON THIS PAGE?       01316
         BL    LINESOK            YES, GO PRINT                         01317
         OI    LCOUNT,X'FF'       NO, FORCE NEW PAGE                    01318
LINESOK  EQU   *                                                        01319
         LA    R0,PMSGAREA        PRINT LINE ADDR                       01320
         B     PRINT              GO PRINT                              01321
UPCOUNT  EQU   *                                                        01322
         LA    R15,16(R15)        BUMP TABLE POINTER                    01323
         LTR   R4,R4              IS THIS FIRST DUP?                    01324
         BNZ   NOTFIRST           NO, CONTINUE TO COUNT DUPS            01325
         MVC   20(8,R1),8(R15)    MOVE FIRST DUP TO PRINT               01326
NOTFIRST EQU   *                                                        01327
         LA    R4,1(R4)           BUMP MAX COUNTER                      01328
         B     DUPLOOP                                                  01329
CHKDUP   EQU   *                                                        01330
         MVC   0(8,R1),0(R15)     MOVE ELEMENT NAME                     01331
         MVC   10(8,R1),8(R15)    MOVE SYSMOD NAME                      01332
DUPLOOP  EQU   *                                                        01333
         LA    R11,16(R15)        LAST ENTRY CHECK                      01334
         C     R11,ENDENTRY       END OF TABLE?                         01335
         BL    DOCOMP             NO, COMPARE TO FIND DUP               01336
         LA    R10,PASSCOMP       SET RETURN TO DO NO MORE CHECKS       01337
         B     ENDCOUNT                                                 01338
DOCOMP   EQU   *                                                        01339
         CLC   0(8,R15),16(R15)   THIS ENTRY SAME AS NEXT?              01340
         BE    UPCOUNT            YES, STEP COUNTERS AND LOOP           01341
ENDCOUNT EQU   *                                                        01342
         LA    R15,16(R15)        BUMP TABLE POINTER                    01343
         C     R4,WORKAREA        DID WE EXCEED PREVIOUS MAX?           01344
         BL    SETCOUNT           NO,                                   01345
         ST    R4,WORKAREA        YES, MAKE THIS NEW MAX                01346
SETCOUNT EQU   *                                                        01347
         SR    R4,R4                                                    01348
         BR    R10                                                      01349
         EJECT                                                          01350
ADDLOOP  EQU   *                                                        01351
         SR    R4,R4                                                    01352
CLOOP    EQU   *                                                        01353
         LA    R11,16(R15)        END CHECK                             01354
         C     R11,ENDENTRY       ARE WE AT END?                        01355
         BE    ENDDUP             YES, GET OUT                          01356
         CLC   0(8,R15),16(R15)   THIS ENTRY SAME AS NEXT               01357
         BNER  R10                NO, RETURN                            01358
         LA    R4,1(R4)           BUMP MAX COUNTER                      01359
         LA    R15,16(R15)        BUMP TABLE POINTER                    01360
         C     R4,PACKDEC+4       IS THIS THE CURRENT DUP?              01361
         BE    MOVEDUP            YES, MOVE IT TO PRINT LINE            01362
         L     R2,PACKDEC+4       GET CURRENT DUP VALUE                 01363
         LA    R2,1(R2)           ADD 1                                 01364
         CR    R4,R2              IS THIS CURRENT VALUE + 1 ?           01365
         BNE   CLOOP              NO, CONTINUE LOOPING                  01366
         LA    R4,1(R4)           BUMP COUNTER FOR THIS DUP             01367
         MVC   10(8,R1),8(R15)    MOVE TO PRINT LINE                    01368
         B     CLOOP              CONTINUE LOOPING                      01369
MOVEDUP  EQU   *                                                        01370
         MVC   0(8,R1),8(R15)     MOVE SYSMOD NAME TO MSGAREA           01371
         B     CLOOP              LOOP TO FIND NEXT ELEMENT             01372
ADDLINE  EQU   *                                                        01373
         L     R15,PACKDEC        TABLE START FOR DUP LINES             01374
         LA    R1,MSGAREA+10      FIRST POSITION                        01375
         BAL   R10,ADDLOOP                                              01376
         LA    R1,MSGAREA+40      SECOND POSITION                       01377
         LA    R15,16(R15)        BUMP TABLE POINTER                    01378
         BAL   R10,ADDLOOP                                              01379
         LA    R1,MSGAREA+70      THIRD POSITION                        01380
         LA    R15,16(R15)        BUMP TABLE POINTER                    01381
         BAL   R10,ADDLOOP                                              01382
ENDDUP   EQU   *                                                        01383
         L     R4,PACKDEC+4       CURRENT DUP NUMBER                    01384
         LA    R4,2(R4)           BUMP BY 2 (2 DUPS/LINE)               01385
         ST    R4,PACKDEC+4       SAVE IT                               01386
         C     R4,WORKAREA        GREATER THAN MAX?                     01387
         BNH   LINESOK            NO,DO NEXT DUP                        01388
         LA    R4,2               RESET                                 01389
         ST    R4,PACKDEC+4       DUP COUNTER                           01390
         SR    R4,R4              RESET                                 01391
         ST    R4,WORKAREA        MAX COUNTER                           01392
         B     LINESOK                                                  01393
         EJECT                                                          01394
         LTORG                                                          01395
         EJECT                                                          01396
PHRA0002 CSECT                                                          01397
         BALR  R12,0                                                    01398
         USING *,R12                                                    01399
         TM    SW2,UT2OPEN        IS SYSUT2 OPEN?                       01400
         BZ    NOSORT             NO, DONT CLOSE IT                     01401
         CLOSE MF=(E,OSYSUT2)                                           01402
         CLOSE MF=(E,OUT2DIR)                                           01403
NOSORT   EQU   *                                                        01404
         BALR R12,0               SET NEW BASE                          01405
         USING *,R12                                                    01406
         BAL   R14,MSG4           DONE MSG                              01407
         TM    SW2,OUTOPEN        IS PTFOUT OPEN?                       01408
         BZ    NOOUTPUT           NO, NO WRITE TO FINISH                01409
         L     R8,ABSAMOUT        ADDR OF BSAM POINTERS                 01410
         BAL   R4,CHKWRITE        FINISH UP OUTPUT                      01411
         CLOSE MF=(E,OPTFOUT)                                           01412
NOOUTPUT EQU   *                                                        01413
         TM    SW2,UT1OPEN        IS SYSUT1 OPEN?                       01414
         BZ    NTSYSUT1           NO, NO CLOSE REQUIRED                 01415
         CLOSE MF=(E,OSYSUT1)                                           01416
NTSYSUT1 EQU   *                                                        01417
         TM    SW2,PUNOPEN        IS SYSPUNCH OPEN?                     01418
         BZ    NPUNO                                                    01419
         CLOSE MF=(E,OPUNCH)                                            01420
         LA    R1,SYSPUNCH                                              01421
         BAL   R10,FREEPOOL                                             01422
NPUNO    EQU   *                                                        01423
         CLOSE MF=(E,ODDS)                                              01424
         LA    R1,PTFDATA         DCB ADDR                              01425
         BAL   R10,FREEPOOL       FREE BUFFERS                          01426
         LA    R1,SYSPRINT        ADDR OF DCB                           01427
         BAL   R10,FREEPOOL                                             01428
         LA    R1,PTFIN           ADDR OF DCB                           01429
         BAL   R10,FREEPOOL                                             01430
         L     R13,4(R13)          SAVE AREA BACK POINTER               01431
         FREEMAIN RU,SP=10                                              01432
         LM    R14,R12,12(R13)    RESTORE REGS                          01433
         SR    R15,R15            ZERO RETURN CODE NO MATTER WHAT       01434
         BR    R14                RETURN                                01435
         SPACE 3                                                        01436
FREEPOOL EQU   *                                                        01437
         FREEPOOL (R1)                                                  01438
         BR    R10                                                      01439
         EJECT                                                          01440
PHRA0003 CSECT                                                          01441
SAVE     DS    18F                                                      01442
         SPACE 3                                                        01443
BSAMWRIT EQU   *                                                        01444
         L     R11,BSAMADDR       ADDR OF BSAM AREA                     01445
         L     R14,BSAMBUFE       END OF BSAM IO AREA                   01446
         S     R14,BSAMBUFC       MINUS CURRENT POINTER                 01447
         BNZ   MOVEBUF            NO, PUT RECORD IN CURRENT BUFFER      01448
DOWRITE  EQU   *                                                        01449
         L     R11,BSAMADDR       ADDR OF BSAM AREA                     01450
         TM    BSAMSW,FIRSTWT     HAVE WE WRITTEN YET?                  01451
         BZ    NOCHECK            NO, NOTHING TO CHECK                  01452
         CHECK (R8)                                                     01453
NOCHECK  EQU   *                                                        01454
         LA    R14,BSAMBUF        START OF IO BUFFER                    01455
         L     R1,BSAMBUFC        CURRENT POINTER                       01456
         CR    R1,R14             EQUAL?                                01457
         BER   R10                YES, NOTHING TO WRITE                 01458
         OI    BSAMSW,FIRSTWT+LASTWT                                    01459
         SR    R1,R14             BLKSIZE FOR WRITE                     01460
         L     R2,DECDCBAD        DCB ADDR                              01461
         STH   R1,DCBBLKSI        BLKSIZE FOR WRITE                     01462
         WRITE (R8),SF,,(R14),'S',MF=E                                  01463
         L     R11,BSAMLINK       ADDR OF OTHER BUFFER AREA             01464
         ST    R11,BSAMADDR       MAKE IT CURRENT                       01465
         BAL   R15,SETUPBUF       RESET BUFFERS                         01466
MOVEBUF  EQU   *                                                        01467
         L     R14,BSAMBUFC       CURRENT POINTER                       01468
         MVC   0(80,R14),RECORD   MOVE OUT RECORD                       01469
         LA    R14,80(R14)        BUMP POINTER                          01470
         ST    R14,BSAMBUFC       MAKE CURRENT                          01471
         BR    R10                                                      01472
         EJECT                                                          01473
BSAMREAD EQU   *                                                        01474
         L     R11,BSAMADDR       ADDR OF BSAM AREA                     01475
         L     R14,BSAMBUFC       ADDR OF CURRENT ENTRY                 01476
         S     R14,BSAMBUFE       MINUS END ADDR                        01477
         BNZ   BUFMOVE            ARE WE AT END?                        01478
DOREAD   EQU   *                                                        01479
         CHECK (R8)                                                     01480
         L     R2,DECDCBAD        DCB ADDR                              01481
         LH    R14,DCBBLKSI       BYTE COUNT FOR READ                   01482
         L     R1,DCBIOBA         ADDR OF IOB                           01483
         SH    R14,22(R1)         MINUS RESIDULE BYTE COUNT             01484
         STH   R14,RDCOUNT                                              01485
         BAL   R4,READ                                                  01486
         ST    R11,BSAMADDR       MAKE IT CURRENT                       01487
         LA    R14,BSAMBUF        START OF IO AREA                      01488
         ST    R14,BSAMBUFC       MAKE IT CURRENT                       01489
         AH    R14,RDCOUNT        LENGTH OF NEXT RECORD                 01490
         ST    R14,BSAMBUFE       END OF IO AREA                        01491
BUFMOVE  EQU   *                                                        01492
         L     R14,BSAMBUFC       CURRENT POINTER                       01493
         MVC   RECORD(80),0(R14)   MOVE INTO RECORD                     01494
         LA    R14,80(R14)        BUMP POINTER                          01495
         ST    R14,BSAMBUFC       MAKE CURRENT                          01496
         BR    R10                RETURN                                01497
         SPACE 2                                                        01498
READ     EQU   *                                                        01499
         LA    R14,BSAMBUF        START OF IO AREA                      01500
         L     R2,DECDCBAD        DCB ADDR                              01501
         LH    R1,BSAMSIZE        MAX READ BLOCK SIZE                   01502
         STH   R1,DCBBLKSI                                              01503
         READ  (R8),SF,,(R14),'S',MF=E                                  01504
         L     R11,BSAMLINK       ADDR OF OTHER BUFFER AREA             01505
         BR    R4                                                       01506
         SPACE 3                                                        01507
SCANRTN  EQU   *                                                        01508
         BAL   R10,SPACES         BYPASS SPACES                         01509
         CLI   REC,C'('           IS IT LEFT PAREN?                     01510
         BNE   ERROR3             NO, SYNTAX ERROR                      01511
         LA    R3,1(R3)           BUMP RECORD POINTER                   01512
SCANRTN1 EQU   *                                                        01513
         BAL   R10,SPACES         SKIP OVER BLANK CHARACTERS            01514
         BAL   R10,LENGTH         GET LENGTH OF ELEMENT NAME            01515
         BR    R11                                                      01516
         EJECT                                                          01517
GETBUF   EQU   *                                                        01518
         LH    R14,DCBBLKSI       MAXIMUM BLOCK SIZE                    01519
         LA    R14,3(R14)         ROUND UP                              01520
         SRL   R14,2              TO NEXT                               01521
         SLL   R14,2              FULL WORD                             01522
         LA    R1,DSSIZE(R14,R14)      GETMAIN SIZE                     01523
         GETMAIN R,LV=(R1),SP=10                                        01524
         ST    R1,0(R8)           SAVE AREA POINTER                     01525
         LR    R8,R1              BASE FOR POINTER AREA                 01526
         LH    R15,DCBBLKSI       MAXIMUM BLKSIZE                       01527
         STH   R15,BSAMSIZE       SAVE FOR LATTER                       01528
         MVI   BSAMSW,X'00'                                             01529
         ST    R2,DECDCBAD        SAVE DCB ADDR                         01530
         LA    R15,PTRSIZE(R8)    ADDR OF FIRST IO AREA                 01531
         ST    R15,BSAMADDR       SAVE AS FIRST BUFFER POINTER          01532
         LA    R11,PREFIX(R15,R14) ADDR OF SECOND IO AREA               01533
         ST    R15,BSAMLINK       LINK BUFFERS                          01534
         ST    R11,BSAMLINK-BSAMAREA(R15)   TOGETHER                    01535
         BAL   R15,SETUPBUF      SET UP BUFFER ADDRESSES                01536
         L     R11,BSAMLINK       OTHER BUFFER NOW                      01537
         BAL   R15,SETUPBUF      SET UP BUFFER ADDRESSES                01538
         BR    R7                                                       01539
         SPACE 3                                                        01540
SETUPBUF EQU   *                                                        01541
         LA    R14,BSAMBUF        ADDR OF BSAM BUFFER                   01542
         ST    R14,BSAMBUFC       MAKE IT CURRENT                       01543
         AH    R14,BSAMSIZE       ADD MAXIMUM BLKSIZE                   01544
         ST    R14,BSAMBUFE       SAVE IN END POINTER                   01545
         BR    R15                                                      01546
         EJECT                                                          01547
CHKWRITE EQU   *                                                        01548
         NI    BSAMSW,255-LASTWT                                        01549
         BAL   R10,DOWRITE        WRITE LAST BUFFER                     01550
         TM    BSAMSW,LASTWT                                            01551
         BZ    NOLWRITE                                                 01552
         CHECK (R8)                                                     01553
NOLWRITE EQU   *                                                        01554
         NI    BSAMSW,255-FIRSTWT-LASTWT                                01555
RESETBUF EQU   *                                                        01556
         BAL   R15,SETUPBUF       SET UP BUFFER ADDRESSES               01557
         L     R11,BSAMLINK       ADDR OF OTHER BUFFER                  01558
         BAL   R15,SETUPBUF       SET UP BUFFER ADDRESSES               01559
         BR    R4                                                       01560
         EJECT                                                          01561
LENGTH   EQU   *                                                        01562
         LR    R5,R3              START OF SCAN                         01563
LENGTH1  EQU   *                                                        01564
         C     R5,RECEND          END OF FIELD?                         01565
         BCR   10,R10             YES, RETURN WITH THIS LENGTH          01566
         CLI   0(R5),C' '         IS IT A BLANK?                        01567
         BE    LENGTH2            YES, RETURN WITH THIS LENGTH          01568
         CLI   0(R5),C'('         IS IT A RIGHT PAREN?                  01569
         BE    LENGTH2            YES, RETURN WITH THIS LENGTH          01570
         CLI   0(R5),C')'         IS IT A LEFT PAREN?                   01571
         BE    LENGTH2            YES, RETURN WITH THIS LENGTH          01572
         CLI   0(R5),C','         IS IT A COMMA?                        01573
         BE    LENGTH2            YES, RETURN WITH THIS LENGTH          01574
         LA    R5,1(R5)           BUMP BY ONE                           01575
         B     LENGTH1                                                  01576
LENGTH2  EQU   *                                                        01577
         SR    R5,R3              CALCULATE LENGTH                      01578
         BR    R10                RETURN                                01579
         SPACE 3                                                        01580
SPACES1  EQU   *                                                        01581
         CLI   REC,SPACE          IS THIS A SPACE?                      01582
         BNE   CKCOMMA            CHECK IF ITS A COMMA                  01583
CKNEXT   EQU   *                                                        01584
         LA    R3,1(R3)           DUMP RECORD POINTER                   01585
SPACES   EQU   *                                                        01586
         C     R3,RECEND          END OF RECORD?                        01587
         BCR   10,R6              YES, RETURN                           01588
         B     SPACES1                                                  01589
CKCOMMA  EQU   *                                                        01590
         CLI   REC,COMMA          IS IT A COMMA?                        01591
         BNER  R10                NO, RETURN                            01592
         B     CKNEXT             YES, CONTINUE CHECKING FOR NO SPACE   01593
         EJECT                                                          01594
ERROR1   EQU   *                                                        01595
         BAL   R10,ERRPRINT       LINK TO ERROR PRINT                   01596
         DC    AL1(L'EMSG1-1)                                           01597
EMSG1    DC    C'UNKNOWN KEYWORD'                                       01598
         DS    0H                                                       01599
ERROR2   EQU   *                                                        01600
         BAL   R10,ERRPRINT       LINK TO ERROR PRINT                   01601
         DC    AL1(L'EMSG2-1)                                           01602
EMSG2    DC    C'SYSMOD NAME MUST 7 CHARACTERS'                         01603
         DS    0H                                                       01604
ERROR3   EQU   *                                                        01605
         MVC   EMSG3+23(7),STOWA  MOVE SYSMOD NAME TO MSG               01606
         BAL   R10,ERRPRINT       LINK TO ERROR PRINT                   01607
         DC    AL1(L'EMSG3-1)                                           01608
EMSG3    DC    C'SYNTAX ERROR IN SYSMOD        '                        01609
         DS    0H                                                       01610
ERROR4   EQU   *                                                        01611
         BAL   R10,PUTEMSG        LINK TO ERROR PRINT                   01612
         DC    AL1(L'EMSG4-1)                                           01613
EMSG4    DC    C'SYSMOD IS TOO LARGE FOR TABLE- DO NOT USE NOMOD'       01614
         DS    0H                                                       01615
ERROR5   EQU   *                                                        01616
         BAL   R10,ERRPRINT       LINK TO ERROR PRINT                   01617
         DC    AL1(L'EMSG5-1)                                           01618
EMSG5    DC    C'DUPLICATE KEYWORD'                                     01619
         DS    0H                                                       01620
ERROR6   EQU   *                                                        01621
         BAL   R10,ERRPRINT       LINK TO ERROR PRINT                   01622
         DC    AL1(L'EMSG6-1)                                           01623
EMSG6    DC    C'SYNTAX ERROR'                                          01624
         DS    0H                                                       01625
ERROR7   EQU   *                                                        01626
         BAL   R10,ERRPRINT       LINK TO ERROR PRINT                   01627
         DC    AL1(L'EMSG7-1)                                           01628
EMSG7    DC    C'SYSMOD LIST TOO LARGE, SPECIFY LARGER LIST SIZE'       01629
         DS    0H                                                       01630
ERROR8   EQU   *                                                        01631
         BAL   R10,PUTEMSG        LINK TO ERROR PRINT                   01632
         DC    AL1(L'EMSG8-1)                                           01633
EMSG8    DC    C'INSUFFICIENT DIRECTORY SPACE FOR SYSUT2'               01634
         DS    0H                                                       01635
ERROR9   EQU   *                                                        01636
         LA    R14,ABEND          ABEND AFTER PRINT                     01637
         BAL   R10,MSGPRINT       LINK TO PRINT MSG RTN                 01638
         DC    AL1(L'EMSG9-1)                                           01639
EMSG9    DC    C'STOW RC=8 FOR ADD REQUEST'                             01640
         DS    0H                                                       01641
ERROR10  EQU   *                                                        01642
         BAL   R10,PUTEMSG                                              01643
         DC    AL1(L'EMSG10-1)                                          01644
EMSG10   DC    C'SYSUT2 DD MISSING'                                     01645
         EJECT                                                          01646
         DS    0H                                                       01647
ERROR11  EQU   *                                                        01648
         BAL   R10,PUTEMSG                                              01649
         DC    AL1(L'EMSG11-1)                                          01650
EMSG11   DC    C'SYSUT1 DD MISSING'                                     01651
         DS    0H                                                       01652
ERROR12  EQU   *                                                        01653
         BAL   R10,PUTEMSG                                              01654
         DC    AL1(L'EMSG12-1)                                          01655
EMSG12   DC    C'EXEC CARD PARMS EXCEED LENGTH OF 100'                  01656
         DS    0H                                                       01657
ERROR13  EQU   *                                                        01658
         BAL   R10,PUTEMSG                                              01659
         DC    AL1(L'EMSG13-1)                                          01660
EMSG13   DC    C'BLOCK PRINT REQUESTED BUT IEFSD095 NOT LINKED'         01661
         DS    0H                                                       01662
MSG1     EQU   *                                                        01663
         MVC   IMSG1+17(7),STOWA  MOVE NAME TO MSG                      01664
         BAL   R10,MSGPRINT       LINK TO PRINT MSG RTN                 01665
         DC    AL1(L'IMSG1-1)                                           01666
IMSG1    DC    C'DUPLICATE OF PTF         FOUND, LAST COPY USED'        01667
         DS    0H                                                       01668
MSG2     EQU   *                                                        01669
         L     R4,RECCOUNT        CURRENT RECORD COUNT                  01670
         CVD   R4,PACKDEC         CONVERT TO DECIMAL                    01671
         SR    R4,R4              CLEAR COUNTER                         01672
         ST    R4,RECCOUNT        FOR NEXT TIME                         01673
         OI    PACKDEC+7,X'0F'    FIX UP LAST BYTE                      01674
         MVC   IMSG2B(9),EDITMASK MAKE RECORD COUNT                     01675
         ED    IMSG2B(8),PACKDEC+4 PRINTABLE                            01676
         LA    R0,IMSG2P                                                01677
         B     PRINT                                                    01678
IMSG2P   DC    X'09'                                                    01679
IMSG2    DC    0CL20'*',20C'*'                                          01680
IMSG2A   DC    C' END OF PTF         ** '                               01681
IMSG2B   DC    0CL57'*',C'         RECORDS ',20C'*',20C' '              01682
         DC    20C' '                                                   01683
         DS    0H                                                       01684
MSG3     EQU   *                                                        01685
         MVC   RECORD+90(8),STOWA NAME TO RIGHT MARGIN                  01686
         MVC   IMSG2+32(8),STOWA  MOVE NAME TO MSG                      01687
         MVC   IMSG2+90(8),STOWA  NAME TO RIGHT MARGIN                  01688
         MVC   IMSG3+25(8),STOWA  MOVE NAME TO MSG                      01689
         MVC   IMSG3+90(8),STOWA  NAME TO RIGHT MARGIN                  01690
         LA    R0,IMSG3P                                                01691
         B     PRINT                                                    01692
IMSG3P   DC    X'09'                                                    01693
IMSG3    DC    0CL20'*',20C'*'                                          01694
IMSG3A   DC    C' PTF         '                                         01695
IMSG3B   DC    0CL67'*',47C'*',20C' '                                   01696
         DC    20C' '                                                   01697
         EJECT                                                          01698
         DS    0H                                                       01699
MSG4     EQU   *                                                        01700
         BAL   R10,MSGPRINT       LINK TO PRINT MSG RTN                 01701
         DC    AL1(L'IMSG4-1)                                           01702
IMSG4    DC    C'PROCESSING COMPLETE'                                   01703
         DS    0H                                                       01704
MSG5     EQU   *                                                        01705
         BAL   R10,MSGPRINT       LINK TO PRINT MSG RTN                 01706
         DC    AL1(L'IMSG5-1)                                           01707
IMSG5    DC    C'PTF         NOT FOUND'                                 01708
         DS    0H                                                       01709
MSG6     EQU   *                                                        01710
         BAL   R10,MSGPRINT       LINK TO PRINT MSG RTN                 01711
         DC    AL1(L'IMSG6-1)                                           01712
IMSG6    DC    C'READING PTFOUT'                                        01713
         DS    0H                                                       01714
MSG7     EQU   *                                                        01715
         BAL   R10,MSGPRINT       LINK TO PRINT MSG RTN                 01716
         DC    AL1(L'IMSG7-1)                                           01717
IMSG7    DC    C'READING PTFIN'                                         01718
         DS    0H                                                       01719
MSG8     EQU   *                                                        01720
         SR    R11,R11            MAKE ENTRY SIZE                       01721
         ST    R11,ESIZE          ZERO                                  01722
         LR    R14,R6             SET RETURN ADDR                       01723
         BAL   R10,MSGPRINT       PRINT MSG                             01724
         DC    AL1(L'IMSG8-1)                                           01725
IMSG8    DC    C'PTFLIST OR XREF TABLE OVERFLOW--FUNCTION DISABLED'     01726
         DS    0H                                                       01727
MSG9     EQU   *                                                        01728
         MVC   IMSG9A(7),STOWA    SYSMOD NAME TO MSG                    01729
         MVC   IMSG9B(8),TEMPNAME ELEMENT NAME TO MSG                   01730
         BAL   R10,MSGPRINT       PRINT MSG                             01731
         DC    AL1(L'IMSG9+L'IMSG9A+L'IMSG9B-1)                         01732
IMSG9    DC    C'NOMOD PROCESSING--SYSMOD '                             01733
IMSG9A   DC    C'        MODULE ELEMENT '                               01734
IMSG9B   DC    C'         DELETED'                                      01735
         DS    0H                                                       01736
MSG10    EQU   *                                                        01737
         MVC   IMSG10(L'IMSG9+L'IMSG9A+L'IMSG9B),IMSG9                  01738
         MVC   IMSG10+90(8),STOWA                                       01739
         LA    R0,IMSG10P                                               01740
         B     PRINT                                                    01741
IMSG10P  DC    X'09'                                                    01742
IMSG10   DC    CL120' '                                                 01743
         EJECT                                                          01744
         DS    0H                                                       01745
ABEND    EQU   *                                                        01746
         ABEND 1,DUMP                                                   01747
         SPACE 3                                                        01748
EMOVE    MVC   MSGAREA(0),1(R10)                                        01749
ERRPRINT EQU   *                                                        01750
         LA    R0,PRECORD         PRINT ADDR FOR RECORD                 01751
         BAL   R14,MPRINT         LINK TO SYSPRINT RTN                  01752
         MVI   RECORD,C' '                                              01753
         MVC   RECORD+1(119),RECORD  MOVE BLANKS ACCROSS RECORD         01754
         MVI   REC,C'*'                                                 01755
         LA    R0,PRECORD                                               01756
         BAL   R14,MPRINT         LINK TO SYSPRINT RTN                  01757
PUTEMSG  EQU   *                                                        01758
         BAL   R14,MSGPRINT       GO DO PRINT                           01759
         CALL  PHRA0002           CLEAN UP AND EXIT                     01760
         SPACE 3                                                        01761
MSGPRINT EQU   *                                                        01762
         MVI   MSGAREA,C' '  BLANK TO MSG AREA                          01763
         MVC   MSGAREA+1(119),MSGAREA   CLEAR TO BLANKS                 01764
         IC    R1,0(R10)          GET MSG LENGTH BYTE                   01765
         EX    R1,EMOVE                                                 01766
         LA    R0,PMSGAREA                                              01767
MPRINT   EQU   *                                                        01768
         LA    R2,SYSPRINT        DCB ADDR                              01769
         LR    R1,R2                                                    01770
         L     R15,DCBWRITE                                             01771
         BR    R15                                                      01772
         SPACE 3                                                        01773
RPRINT   EQU   *                                                        01774
         LA    R0,SKIP            SKIP TO ONE                           01775
         SR    R15,R15            SET LINE COUNT TO ZERO                01776
         B     RPRINT1                                                  01777
PRINT    EQU   *                                                        01778
         L     R15,LCOUNT         CURRENT LINE COUNT                    01779
         CL    R15,MAXLINES       ARE WE AT MAX?                        01780
         BL    NOSKIP             NO, DO PRINT                          01781
         STM   R14,R1,PRINTSAV    SAVE REGS OVER SKIP TO 1              01782
         PUT   PTFDATA,SKIP       SKIP TO 1                             01783
         LM    R14,R1,PRINTSAV                                          01784
         SR    R15,R15            RESTART LINE COUNT                    01785
NOSKIP   EQU   *                                                        01786
         LA    R15,1(R15)                                               01787
RPRINT1  EQU   *                                                        01788
         ST    R15,LCOUNT         SAVE LINE COUNT                       01789
         LA    R2,PTFDATA                                               01790
         LR    R1,R2              DCB ADDR FOR PUT                      01791
         L     R15,DCBWRITE       ADDR OF PUT ROUTINE                   01792
         BR    R15                BRANCH TO PUT ROUTINE                 01793
         EJECT                                                          01794
TBLSORT  EQU   *                                                        01795
         L     R11,ESIZE          ENTRY SIZE                            01796
         LTR   R11,R11            IS ENTRY SIZE ZERO?                   01797
         BZR   R6                 YES, RETURN                           01798
         L     R14,LOWENTRY       ADDR OF LOWEST ENTRY                  01799
         LA    R0,TSTART          START OF TABLE                        01800
         CR    R0,R14             IS TABLE FULL?                        01801
         BE    MSG8               PUT OUT ERROR MSG                     01802
         LR    R15,R14            SAVE START POINTER                    01803
COMPLOOP EQU   *                                                        01804
         EX    R11,COMP1          COMPARE OBJECT TO TABLE ENTRY         01805
         BER   R6                 DO NOT MAKE DUPLICATE ENTRIES         01806
         BNH   MOVEIT             MOVE IF NOT HIGHER THAN TABLE         01807
         ST    R15,WORKAREA       INSERT ADDR                           01808
         LA    R15,1(R11,R15)     INCREMENT TABLE POINTER               01809
         C     R15,ENDENTRY       END OF TABLE?                         01810
         BNE   COMPLOOP           NO, LOOP TO COMPARE                   01811
MOVEIT   EQU   *                                                        01812
         SR    R15,R14            LENGTH OF MOVE                        01813
         LR    R1,R11             ENTRY SIZE MINUS 1                    01814
         LA    R1,1(R1)           ENTRY SIZE                            01815
         L     R0,LOWENTRY        ADDR OF LOWEST ENTRY                  01816
         SR    R0,R1              NEW LOWEST ENTRY ADDR                 01817
         ST    R0,LOWENTRY        SAVE IT                               01818
         LR    R1,R15             LENGTH OF MOVE                        01819
         MVCL  R0,R14             DO MOVE                               01820
         L     R15,WORKAREA       INSERT ADDR                           01821
         EX    R11,MOVETBL1        PLACE ENTRY INTO TABLE               01822
         BR    R6                                                       01823
         SPACE 3                                                        01824
COMP1    CLC   0(0,R10),0(R15)                                          01825
MOVETBL1 MVC   0(0,R15),0(R10)                                          01826
         EJECT                                                          01827
R0       EQU   0                                                        01828
R1       EQU   1                                                        01829
R2       EQU   2                                                        01830
R3       EQU   3                                                        01831
R4       EQU   4                                                        01832
R5       EQU   5                                                        01833
R6       EQU   6                                                        01834
R7       EQU   7                                                        01835
R8       EQU   8                                                        01836
R9       EQU   9                                                        01837
R10      EQU   10                                                       01838
R11      EQU   11                                                       01839
R12      EQU   12                                                       01840
R13      EQU   13                                                       01841
R14      EQU   14                                                       01842
R15      EQU   15                                                       01843
         SPACE 3                                                        01844
COMMA    EQU   C','                                                     01845
SPACE    EQU   C' '                                                     01846
SW       DC    X'00'                                                    01847
HEADER   EQU   128                                                      01848
EXCLUDE  EQU   64                                                       01849
NRDBACK  EQU   32                                                       01850
NOMOD    EQU   16                                                       01851
LIST     EQU   8                                                        01852
SORT     EQU   4                                                        01853
PTFSEL   EQU   2                                                        01854
DISPOLD  EQU   1                                                        01855
SW2      DC    X'00'                                                    01856
UT2OPEN  EQU   128                                                      01857
INNOMOD  EQU   64                                                       01858
UT1LOOP  EQU   32                                                       01859
UT1OPEN  EQU   16                                                       01860
OUTOPEN  EQU   8                                                        01861
PUNOPEN  EQU   4                                                        01862
SYSMOD   EQU   2                                                        01863
PHEADER  EQU   1                                                        01864
SW3      DC    X'00'                                                    01865
XREF     EQU   128                                                      01866
PTFLIST  EQU   64                                                       01867
NOMERGE  EQU   32                                                       01868
EJECT    EQU   16                                                       01869
DOSCAN   EQU   8                                                        01870
EOFPTFIN EQU   4                                                        01871
SYINOPEN EQU   2                                                        01872
BLOCK    EQU   1                                                        01873
SW4      DC    X'00'                                                    01874
NLISTALL EQU   128                                                      01875
NCOMMENT EQU   64                                                       01876
LISTREC  EQU   32                                                       01877
FMIDLIST EQU   16                                                       01878
LINES    EQU   8                                                        01879
NINVER   EQU   4                                                        01880
FMIDPARN EQU   2                                                        01881
FMIDID   EQU   1                                                        01882
         EJECT                                                          01883
         PRINT NOGEN                                                    01884
SYSUT2   DCB   DDNAME=SYSUT2,DSORG=PO,MACRF=(R,W),BLKSIZE=3040,        X01885
               RECFM=U,EODAD=UT2EOF,EXLST=XLIST                         01886
UT2DIR   DCB   DDNAME=SYSUT2,DSORG=PS,MACRF=R,KEYLEN=8,EODAD=DIREOF,   X01887
               RECFM=F,LRECL=256,BLKSIZE=256                            01888
PTFIN    DCB   DDNAME=PTFIN,DSORG=PS,EODAD=PTFINEOF,MACRF=GM,LRECL=80   01889
PTFOUT   DCB   DDNAME=PTFOUT,DSORG=PS,MACRF=(R,W),EXLST=XLIST,         X01890
               EODAD=POUTEOF                                            01891
SYSPUNCH DCB   DDNAME=SYSPUNCH,DSORG=PS,MACRF=PM,LRECL=80,EXLST=XLIST   01892
SYSPRINT DCB   DDNAME=SYSPRINT,DSORG=PS,LRECL=121,BLKSIZE=121,         X01893
               MACRF=PM,RECFM=FM                                        01894
PTFDATA  DCB   DDNAME=PTFDATA,DSORG=PS,LRECL=121,MACRF=PM,RECFM=FBM     01895
SYSUT1   DCB   DDNAME=SYSUT1,DSORG=PS,MACRF=(R,W),BLKSIZE=3040,        X01896
               RECFM=U,EODAD=UT1EOF,EXLST=XLIST                         01897
OUT2DIR  OPEN  (UT2DIR,INPUT),MF=L                                      01898
OPUNCH   OPEN  (SYSPUNCH,OUTPUT),MF=L                                   01899
OSYSUT1  OPEN  (SYSUT1,OUTIN),MF=L                                      01900
OSYSUT2  OPEN  (SYSUT2,OUTIN),MF=L                                      01901
OPTFOUT  OPEN  (PTFOUT,INOUT),MF=L                                      01902
ODDS     OPEN  (PTFIN,,SYSPRINT,OUTPUT,PTFDATA,OUTPUT),MF=L             01903
TADDR    DC    A(1)         ENTRY SIZE * SYSMODS                        01904
XREFADDR DC    A(8)         ENTRY SIZE * SYSMODS * ELEMENTS/SYSMOD      01905
FMIDADDR DC    A(4)         ENTRY SIZE * SYSMODS * ++VER/SYSMOD         01906
SMCOUNT  DC    A(1500)      DEFAULT SYSMOD COUNT VALUE                  01907
MAXLINES DC    F'55'                                                    01908
FOURTEEN DC    F'14'                                                    01909
LCOUNT   DC    F'55'                                                    01910
APTFLIST DC    F'50'                                                    01911
NAMELIST DC    F'800'                                                   01912
APUTRTN  DC    A(PUTPTF)                                                01913
RECEND   DC    A(RECORD+100)                                            01914
USERL    DC    A(STODATSZ)                                              01915
TTRMASK  DC    (L'STOTTR)X'FF',(L'STOCTTRN)X'00'                        01916
XLIST    DC    X'87',AL3(INFMJFCB)                                      01917
BLKPARM  DC    A(STOWA)                                                 01918
         DC    A(COUNT)                                                 01919
         DC    A(MSGAREA)                                               01920
         DC    A(DATASIZE)                                              01921
COUNT    DC    F'0'                                                     01922
DATASIZE DC    F'7'                                                     01923
BLOCKPT  DC    V(IEFSD095)        SYS1.AOSB0                            01924
MAXCOUNT DC    F'13'                                                    01925
RECCOUNT DC    F'0'                                                     01926
EDITMASK DC    X'402020202020202040'                                    01927
SKIP     DC    X'8B',CL90'       SKIP TO ONE'                           01928
SKIPNAME DC    30C' '                                                   01929
PRECORD  DC    X'09'                                                    01930
RECORD   DC    120C' '                                                  01931
ERECORD  EQU   RECORD+71                                                01932
PMSGAREA DC    X'09'                                                    01933
MSGAREA  DC    120C' '                                                  01934
         EJECT                                                          01935
         LTORG                                                          01936
PACKDEC  DS    D                                                        01937
ENDPTFL  DS    F                                                        01938
ENDNAMEL DS    F                                                        01939
CNAMEL   DS    F                                                        01940
ABSAMUT1 DS    F                                                        01941
ABSAMUT2 DS    F                                                        01942
ABSAMOUT DS    F                                                        01943
PRINTSAV DS    4F                                                       01944
AGETRTN  DS    F                                                        01945
SAVER10  DS    F                                                        01946
CURDE    DS    F                                                        01947
         DS    0F                                                       01948
JFCB     IEFJFCBN LIST=YES                                              01949
TEMPNAME DS    16C                                                      01950
STOWA    DS    CL(STOWSIZE)                                             01951
KEY      DS    8C                                                       01952
LEN      DS    2C                                                       01953
DIR      DS    254C                                                     01954
         DCBD  DSORG=(PS,PO)                                            01955
         END                                                            01956
